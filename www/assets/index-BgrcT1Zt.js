import{r as m}from"./index-BrlLxRfg.js";const Y="Left",A="Right",I="Up",H="Down",O={delta:10,preventScrollOnSwipe:!1,rotationAngle:0,trackMouse:!1,trackTouch:!0,swipeDuration:1/0,touchEventOptions:{passive:!0}},U={first:!0,initial:[0,0],start:0,swiping:!1,xy:[0,0]},x="mousemove",k="mouseup",$="touchend",q="touchmove",B="touchstart";function C(c,r,s,o){return c>r?s>0?A:Y:o>0?H:I}function R(c,r){if(r===0)return c;const s=Math.PI/180*r,o=c[0]*Math.cos(s)+c[1]*Math.sin(s),l=c[1]*Math.cos(s)-c[0]*Math.sin(s);return[o,l]}function F(c,r){const s=n=>{const t="touches"in n;t&&n.touches.length>1||c((e,i)=>{i.trackMouse&&!t&&(document.addEventListener(x,o),document.addEventListener(k,b));const{clientX:a,clientY:f}=t?n.touches[0]:n,u=R([a,f],i.rotationAngle);return i.onTouchStartOrOnMouseDown&&i.onTouchStartOrOnMouseDown({event:n}),Object.assign(Object.assign(Object.assign({},e),U),{initial:u.slice(),xy:u,start:n.timeStamp||0})})},o=n=>{c((t,e)=>{const i="touches"in n;if(i&&n.touches.length>1)return t;if(n.timeStamp-t.start>e.swipeDuration)return t.swiping?Object.assign(Object.assign({},t),{swiping:!1}):t;const{clientX:a,clientY:f}=i?n.touches[0]:n,[u,v]=R([a,f],e.rotationAngle),w=u-t.xy[0],j=v-t.xy[1],g=Math.abs(w),d=Math.abs(j),M=(n.timeStamp||0)-t.start,P=Math.sqrt(g*g+d*d)/(M||1),X=[w/(M||1),j/(M||1)],E=C(g,d,w,j),y=typeof e.delta=="number"?e.delta:e.delta[E.toLowerCase()]||O.delta;if(g<y&&d<y&&!t.swiping)return t;const T={absX:g,absY:d,deltaX:w,deltaY:j,dir:E,event:n,first:t.first,initial:t.initial,velocity:P,vxvy:X};T.first&&e.onSwipeStart&&e.onSwipeStart(T),e.onSwiping&&e.onSwiping(T);let L=!1;return(e.onSwiping||e.onSwiped||e[`onSwiped${E}`])&&(L=!0),L&&e.preventScrollOnSwipe&&e.trackTouch&&n.cancelable&&n.preventDefault(),Object.assign(Object.assign({},t),{first:!1,eventData:T,swiping:!0})})},l=n=>{c((t,e)=>{let i;if(t.swiping&&t.eventData){if(n.timeStamp-t.start<e.swipeDuration){i=Object.assign(Object.assign({},t.eventData),{event:n}),e.onSwiped&&e.onSwiped(i);const a=e[`onSwiped${i.dir}`];a&&a(i)}}else e.onTap&&e.onTap({event:n});return e.onTouchEndOrOnMouseUp&&e.onTouchEndOrOnMouseUp({event:n}),Object.assign(Object.assign(Object.assign({},t),U),{eventData:i})})},h=()=>{document.removeEventListener(x,o),document.removeEventListener(k,b)},b=n=>{h(),l(n)},S=(n,t)=>{let e=()=>{};if(n&&n.addEventListener){const i=Object.assign(Object.assign({},O.touchEventOptions),t.touchEventOptions),a=[[B,s,i],[q,o,Object.assign(Object.assign({},i),t.preventScrollOnSwipe?{passive:!1}:{})],[$,l,i]];a.forEach(([f,u,v])=>n.addEventListener(f,u,v)),e=()=>a.forEach(([f,u])=>n.removeEventListener(f,u))}return e},p={ref:n=>{n!==null&&c((t,e)=>{if(t.el===n)return t;const i={};return t.el&&t.el!==n&&t.cleanUpTouch&&(t.cleanUpTouch(),i.cleanUpTouch=void 0),e.trackTouch&&n&&(i.cleanUpTouch=S(n,e)),Object.assign(Object.assign(Object.assign({},t),{el:n}),i)})}};return r.trackMouse&&(p.onMouseDown=s),[p,S]}function G(c,r,s,o){return!r.trackTouch||!c.el?(c.cleanUpTouch&&c.cleanUpTouch(),Object.assign(Object.assign({},c),{cleanUpTouch:void 0})):c.cleanUpTouch?r.preventScrollOnSwipe!==s.preventScrollOnSwipe||r.touchEventOptions.passive!==s.touchEventOptions.passive?(c.cleanUpTouch(),Object.assign(Object.assign({},c),{cleanUpTouch:o(c.el,r)})):c:Object.assign(Object.assign({},c),{cleanUpTouch:o(c.el,r)})}function N(c){const{trackMouse:r}=c,s=m.useRef(Object.assign({},U)),o=m.useRef(Object.assign({},O)),l=m.useRef(Object.assign({},o.current));l.current=Object.assign({},o.current),o.current=Object.assign(Object.assign({},O),c);let h;for(h in O)o.current[h]===void 0&&(o.current[h]=O[h]);const[b,S]=m.useMemo(()=>F(D=>s.current=D(s.current,o.current),{trackMouse:r}),[r]);return s.current=G(s.current,o.current,l.current,S),b}export{N as u};
