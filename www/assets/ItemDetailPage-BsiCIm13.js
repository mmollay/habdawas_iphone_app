import{g as vt,a as wt,r as h,u as kt,j as e,s as St,c as zt,b as Ct,m as It,d as $s,k as Hs,e as Ze,f as Qe,h as Je,D as Us,i as Os,B as t,S as Fe,T as a,I as m,X as es,l as Ks,n as Ke,o as Wt,C as Ws,L as Rt,p as ke,q as Se,t as ze,M as Ft,v as Ce,w as Q,x as Tt,P as Et,y as W,Q as Nt,z as At,A as Gs,E as Xs,F as te,G as k,H as Ys,J as Zs,K as Dt,N as Qs,O as Ge,R as Js,U as Mt,V as Lt,W as G,Y as Pt,Z as Vt,_ as Bt,$ as qt,a0 as Rs,a1 as Fs,a2 as Z,a3 as Ts,a4 as Le,a5 as $t,a6 as Ie,a7 as Es,a8 as Pe,a9 as Ve,aa as Ht,ab as Ut,ac as Be,ad as Ns,ae as qe,af as As,ag as Ot,ah as Ds,ai as Ms,aj as $e,ak as Kt,al as We,am as Gt}from"./index-DGPOwJJr.js";import{u as Ls}from"./index-BcVG1dEp.js";import{I as Ps,a as L,R as Vs,W as Xt,B as Yt,b as Re,H as Zt,c as Qt}from"./InlineImageGallery-OtEn59I-.js";import{S as He}from"./star-CCnGXB6K.js";import{C as O,M as Bs}from"./Modal-Dhaeircd.js";import{C as Jt}from"./CategoryDropdown-C5_L9UJB.js";import{X as er,C as qs}from"./x-circle-CmvsgzW0.js";import{P as sr}from"./phone-LmM7JZ8B.js";import{S as tr}from"./send-Dsz_AqS5.js";import"./plus-B36wF7R5.js";import"./Search-B8gagK-N.js";function rr(c){return String(c).match(/[\d.\-+]*\s*(.*)/)[1]||""}function ir(c){return parseFloat(c)}function ar(c){return vt("MuiSkeleton",c)}wt("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const nr=c=>{const{classes:d,variant:p,animation:n,hasChildren:g,width:u,height:b}=c;return Ct({root:["root",p,n,g&&"withChildren",g&&!u&&"fitContent",g&&!b&&"heightAuto"]},ar,d)},Xe=Hs`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,Ye=Hs`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,or=typeof Xe!="string"?$s`
        animation: ${Xe} 2s ease-in-out 0.5s infinite;
      `:null,lr=typeof Ye!="string"?$s`
        &::after {
          animation: ${Ye} 2s linear 0.5s infinite;
        }
      `:null,cr=St("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(c,d)=>{const{ownerState:p}=c;return[d.root,d[p.variant],p.animation!==!1&&d[p.animation],p.hasChildren&&d.withChildren,p.hasChildren&&!p.width&&d.fitContent,p.hasChildren&&!p.height&&d.heightAuto]}})(It(({theme:c})=>{const d=rr(c.shape.borderRadius)||"px",p=ir(c.shape.borderRadius);return{display:"block",backgroundColor:c.vars?c.vars.palette.Skeleton.bg:c.alpha(c.palette.text.primary,c.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${p}${d}/${Math.round(p/.6*10)/10}${d}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(c.vars||c).shape.borderRadius}},{props:({ownerState:n})=>n.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:n})=>n.hasChildren&&!n.width,style:{maxWidth:"fit-content"}},{props:({ownerState:n})=>n.hasChildren&&!n.height,style:{height:"auto"}},{props:{animation:"pulse"},style:or||{animation:`${Xe} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(c.vars||c).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:lr||{"&::after":{animation:`${Ye} 2s linear 0.5s infinite`}}}]}})),Ue=h.forwardRef(function(d,p){const n=kt({props:d,name:"MuiSkeleton"}),{animation:g="pulse",className:u,component:b="span",height:z,style:j,variant:o="text",width:s,...C}=n,A={...n,animation:g,component:b,variant:o,hasChildren:!!C.children},P=nr(A);return e.jsx(cr,{as:b,ref:p,className:zt(P.root,u),ownerState:A,...C,style:{width:s,height:z,...j}})});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dr=Ze("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hr=Ze("Fuel",[["line",{x1:"3",x2:"15",y1:"22",y2:"22",key:"xegly4"}],["line",{x1:"4",x2:"14",y1:"9",y2:"9",key:"xcnuvu"}],["path",{d:"M14 22V4a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v18",key:"16j0yd"}],["path",{d:"M14 13h2a2 2 0 0 1 2 2v2a2 2 0 0 0 2 2h0a2 2 0 0 0 2-2V9.83a2 2 0 0 0-.59-1.42L18 5",key:"8ur5zv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=Ze("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),xr=({open:c,onClose:d,url:p,title:n,price:g,description:u})=>{const b=Qe(),z=Je(b.breakpoints.down("md")),[j,o]=h.useState(!1),[s,C]=h.useState(!1),[A,P]=h.useState(""),H=g!==void 0?`${n} - ${g.toFixed(2)} €`:n,X=async()=>{try{await navigator.clipboard.writeText(p),P("Link in Zwischenablage kopiert!"),C(!0)}catch{const T=document.createElement("textarea");T.value=p,T.style.position="fixed",T.style.left="-999999px",document.body.appendChild(T),T.select();try{document.execCommand("copy"),P("Link in Zwischenablage kopiert!"),C(!0)}catch{P("Kopieren fehlgeschlagen"),C(!0)}document.body.removeChild(T)}},y=async()=>{if(navigator.share)try{await navigator.share({title:n,text:H,url:p}),d()}catch(D){D.name!=="AbortError"&&console.error("Error sharing:",D)}else X()},V=()=>{window.open(`https://wa.me/?text=${encodeURIComponent(H+" "+p)}`,"_blank"),d()},K=()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(p)}&text=${encodeURIComponent(H)}`,"_blank"),d()},Y=()=>{const D=n,T=g!==void 0?`${n}

Preis: ${g.toFixed(2)} €

${p}`:`${n}

${p}`;window.location.href=`mailto:?subject=${encodeURIComponent(D)}&body=${encodeURIComponent(T)}`,d()},J=()=>{d(),setTimeout(()=>window.print(),100)};return e.jsxs(e.Fragment,{children:[e.jsxs(Us,{open:c,onClose:d,maxWidth:"sm",fullWidth:!0,fullScreen:z,PaperProps:{sx:{borderRadius:z?0:3}},children:[e.jsxs(Os,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Fe,{size:24}),e.jsx(a,{variant:"h6",component:"span",children:"Teilen"})]}),e.jsx(m,{onClick:d,size:"small",children:e.jsx(es,{size:20})})]}),e.jsx(Ks,{children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle1",fontWeight:600,children:n}),g!==void 0&&e.jsxs(a,{variant:"body2",color:"text.secondary",children:[g.toFixed(2)," €"]})]}),e.jsx(t,{children:e.jsx(Ke,{fullWidth:!0,value:p,InputProps:{readOnly:!0,endAdornment:e.jsx(Wt,{title:"Kopieren",children:e.jsx(m,{onClick:X,edge:"end",size:"small",children:e.jsx(Ws,{size:18})})}),sx:{fontFamily:"monospace",fontSize:"0.875rem"}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"action.hover"}}})}),e.jsxs(t,{children:[e.jsx(a,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:"Teilen über"}),e.jsxs(Rt,{sx:{border:"1px solid",borderColor:"divider",borderRadius:2,p:0,overflow:"hidden"},children:[e.jsx(ke,{disablePadding:!0,children:e.jsxs(Se,{onClick:V,children:[e.jsx(ze,{sx:{minWidth:40},children:e.jsx(Ft,{size:20,color:"#25D366"})}),e.jsx(Ce,{primary:"WhatsApp"})]})}),e.jsx(Q,{}),e.jsx(ke,{disablePadding:!0,children:e.jsxs(Se,{onClick:K,children:[e.jsx(ze,{sx:{minWidth:40},children:e.jsx(t,{sx:{width:20,height:20},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"#0088cc",children:e.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002 0-.003 0-.005 0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"})})})}),e.jsx(Ce,{primary:"Telegram"})]})}),e.jsx(Q,{}),e.jsx(ke,{disablePadding:!0,children:e.jsxs(Se,{onClick:Y,children:[e.jsx(ze,{sx:{minWidth:40},children:e.jsx(Tt,{size:20})}),e.jsx(Ce,{primary:"E-Mail"})]})}),e.jsx(Q,{}),e.jsx(ke,{disablePadding:!0,children:e.jsxs(Se,{onClick:J,children:[e.jsx(ze,{sx:{minWidth:40},children:e.jsx(Et,{size:20})}),e.jsx(Ce,{primary:"Drucken"})]})})]})]}),e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(a,{variant:"subtitle2",fontWeight:600,children:"QR-Code"}),e.jsx(W,{size:"small",startIcon:e.jsx(Nt,{size:16}),onClick:()=>o(!j),sx:{textTransform:"none"},children:j?"Ausblenden":"Anzeigen"})]}),j&&e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:3,bgcolor:"background.paper",borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsx(At,{value:p,size:z?200:256,level:"H",includeMargin:!0,style:{border:"8px solid white",borderRadius:"8px"}})})]}),e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic"},children:"💡 Teile diesen Link, um anderen dieses Inserat zu zeigen."})]})}),e.jsxs(Gs,{sx:{px:3,pb:3,gap:1,flexWrap:"wrap"},children:[e.jsx(W,{onClick:d,variant:"outlined",sx:{textTransform:"none"},children:"Schließen"}),e.jsx(W,{onClick:X,variant:"outlined",startIcon:e.jsx(Ws,{size:18}),sx:{textTransform:"none"},children:"Link kopieren"}),navigator.share&&e.jsx(W,{onClick:y,variant:"contained",startIcon:e.jsx(Fe,{size:18}),sx:{textTransform:"none"},children:"Teilen"})]})]}),e.jsx(Xs,{open:s,autoHideDuration:3e3,onClose:()=>C(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(te,{onClose:()=>C(!1),severity:"success",variant:"filled",sx:{width:"100%"},children:A})})]})},pr=()=>{const c=document.createElement("canvas"),d=c.getContext("2d");d&&(d.textBaseline="top",d.font="14px Arial",d.fillText("fingerprint",2,2));const p=[navigator.userAgent,navigator.language,screen.colorDepth,screen.width,screen.height,new Date().getTimezoneOffset(),c.toDataURL()].join("|");let n=0;for(let g=0;g<p.length;g++){const u=p.charCodeAt(g);n=(n<<5)-n+u,n=n&n}return Math.abs(n).toString(36)},gr=c=>{try{return JSON.parse(sessionStorage.getItem("viewedItems")||"[]").includes(c)}catch{return!1}},fr=c=>{try{const d=JSON.parse(sessionStorage.getItem("viewedItems")||"[]");d.includes(c)||(d.push(c),sessionStorage.setItem("viewedItems",JSON.stringify(d)))}catch(d){console.error("Failed to mark item as viewed:",d)}},ur=(c,d=!1)=>{h.useEffect(()=>{if(!c||!d||gr(c))return;const n=setTimeout(async()=>{try{const{data:{user:g}}=await k.auth.getUser(),{error:u}=await k.from("item_views").insert({item_id:c,viewer_id:(g==null?void 0:g.id)||null,session_fingerprint:g?null:pr()});u&&!u.message.includes("unique")?console.error("Failed to track view:",u):fr(c)}catch(g){console.error("Failed to track view:",g)}},2e3);return()=>clearTimeout(n)},[c,d])},mr=({itemId:c,draftData:d,enabled:p,debounceMs:n=1e3})=>{const[g,u]=h.useState("idle"),b=h.useRef(null),z=h.useRef("");return h.useEffect(()=>{if(!p)return;const j=JSON.stringify(d);if(j!==z.current)return z.current=j,b.current&&clearTimeout(b.current),u("saving"),b.current=setTimeout(async()=>{try{const{error:o}=await k.from("items").update({draft_data:d,has_draft:!0,draft_updated_at:new Date().toISOString()}).eq("id",c);if(o)throw o;u("saved"),setTimeout(()=>{u("idle")},2e3)}catch(o){console.error("Auto-save error:",o),u("error")}},n),()=>{b.current&&clearTimeout(b.current)}},[c,d,p,n]),{status:g}},br=()=>{const{user:c}=Ys(),[d,p]=h.useState([]),[n,g]=h.useState(!0);return h.useEffect(()=>{(async()=>{if(!c){p([]),g(!1);return}try{const{data:o,error:s}=await k.rpc("get_user_permissions",{check_user_id:c.id});if(s)throw s;const C=(o==null?void 0:o.map(A=>A.permission_name))||[];p(C)}catch(o){console.error("Error loading permissions:",o),p([])}finally{g(!1)}})()},[c]),{permissions:d,loading:n,hasPermission:j=>d.includes(j),hasAnyPermission:j=>j.some(o=>d.includes(o)),hasAllPermissions:j=>j.every(o=>d.includes(o))}},jr=({onPublish:c,onCancel:d,isPublishing:p,autoSaveStatus:n,hasChanges:g,isDraft:u,itemStatus:b})=>{const z=Qe(),j=Je(z.breakpoints.down("md")),[o,s]=h.useState(!1);h.useEffect(()=>{if(n==="saving")s(!0);else if(n==="saved"){const P=setTimeout(()=>{s(!1)},1500);return()=>clearTimeout(P)}else(n==="idle"||n==="error")&&s(!1)},[n]);const C=()=>p||!o?null:n==="saving"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"primary.main",animation:"pulse 1.5s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.6},"50%":{opacity:1}}},children:e.jsx(He,{size:16})}):n==="saved"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"success.main",animation:"fadeIn 0.3s ease-in","@keyframes fadeIn":{"0%":{opacity:0,transform:"scale(0.8)"},"100%":{opacity:1,transform:"scale(1)"}}},children:e.jsx(He,{size:16})}):n==="error"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"error.main"},children:e.jsx(He,{size:16})}):null,A=()=>p?u?"Wird veröffentlicht...":"Wird gespeichert...":b==="draft"?"Veröffentlichen":b==="published"?"Änderungen speichern":b==="paused"?"Speichern":"Änderungen übernehmen";return e.jsx(e.Fragment,{children:e.jsxs(Zs,{elevation:8,sx:{position:"fixed",bottom:j?16:32,left:"50%",transform:"translateX(-50%)",zIndex:1300,bgcolor:"background.paper",borderRadius:4,border:u?"2px solid":"1px solid",borderColor:u?"warning.main":"divider",boxShadow:u?"0 12px 48px rgba(237, 108, 2, 0.15)":"0 8px 32px rgba(0,0,0,0.08)",minWidth:j?"calc(100% - 32px)":"auto",maxWidth:j?"calc(100% - 32px)":600,overflow:"hidden"},children:[u&&e.jsxs(t,{sx:{bgcolor:"rgba(237, 108, 2, 0.04)",px:2.5,py:.75,borderBottom:"1px solid rgba(237, 108, 2, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:1.5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Dt,{size:14,color:"#ed6c02",style:{flexShrink:0}}),e.jsx(a,{variant:"body2",sx:{color:"#e65100",fontSize:"0.8125rem",fontWeight:500},children:"Änderungen werden automatisch gespeichert"})]}),e.jsx(t,{sx:{display:"flex",alignItems:"center",minWidth:20},children:C()})]}),e.jsxs(t,{sx:{p:1.5,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1.5,flexDirection:"row",position:"relative"},children:[e.jsx(W,{variant:"outlined",onClick:d,disabled:p,startIcon:e.jsx(es,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:2.5,fontWeight:500},children:"Abbrechen"}),e.jsx(W,{variant:"contained",onClick:c,disabled:p||!g,startIcon:e.jsx(Qs,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:3,fontWeight:600,bgcolor:u?"warning.main":"primary.main","&:hover":{bgcolor:u?"warning.dark":"primary.dark"}},children:A()})]})]})})},yr=({show:c,targetElement:d,onClose:p,title:n,description:g,step:u=1,totalSteps:b=1})=>{const[z,j]=h.useState({top:0,left:0});return h.useEffect(()=>{if(!c||!d)return;const o=()=>{const s=d.getBoundingClientRect(),C=window.scrollY,A=window.scrollX;j({top:s.top+C-180,left:s.left+A+s.width/2})};return o(),window.addEventListener("resize",o),window.addEventListener("scroll",o),()=>{window.removeEventListener("resize",o),window.removeEventListener("scroll",o)}},[c,d]),!c||!d?null:e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0, 0, 0, 0.4)",zIndex:1400,animation:"fadeIn 0.3s ease-in-out","@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}}},onClick:p}),e.jsxs(t,{sx:{position:"absolute",top:z.top,left:z.left,transform:"translateX(-50%)",zIndex:1401,animation:"slideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)","@keyframes slideDown":{from:{opacity:0,transform:"translateX(-50%) translateY(-20px)"},to:{opacity:1,transform:"translateX(-50%) translateY(0)"}}},children:[e.jsxs(Zs,{elevation:24,sx:{position:"relative",bgcolor:"white",borderRadius:3,p:3,maxWidth:360,boxShadow:"0 24px 64px rgba(0, 0, 0, 0.24)",border:"1px solid rgba(0, 0, 0, 0.06)","&::after":{content:'""',position:"absolute",bottom:-12,left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"12px solid transparent",borderRight:"12px solid transparent",borderTop:"12px solid white",filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1))"}},children:[e.jsx(m,{onClick:p,sx:{position:"absolute",top:8,right:8,width:32,height:32,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(es,{size:18})}),e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[e.jsx(t,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 12px rgba(25, 118, 210, 0.3)"},children:e.jsx(Ge,{size:20,color:"white"})}),e.jsxs(t,{sx:{flex:1,pt:.5},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,mb:.5,color:"text.primary"},children:n}),b>1&&e.jsxs(a,{variant:"caption",sx:{color:"text.secondary",fontWeight:500},children:["Schritt ",u," von ",b]})]})]}),e.jsx(a,{variant:"body2",sx:{color:"text.secondary",lineHeight:1.6,mb:3},children:g}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:e.jsx(W,{onClick:p,variant:"contained",sx:{borderRadius:2,textTransform:"none",fontWeight:600,px:3,boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(25, 118, 210, 0.24)"}},children:"Verstanden"})})]}),e.jsx(t,{sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",mt:2,width:2,height:40,bgcolor:"primary.main",borderRadius:1,opacity:.4,animation:"pulse 2s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.4},"50%":{opacity:.8}}}})]})]})},_r=({userId:c,currentItemId:d})=>{const[p,n]=h.useState(null),[g,u]=h.useState([]),[b,z]=h.useState(0),[j,o]=h.useState(!0),s=Js();h.useEffect(()=>{C()},[c]);const C=async()=>{try{const{data:y,error:V}=await k.from("profiles").select("id, full_name, avatar_url, created_at, show_seller_profile").eq("id",c).single();if(V)throw V;if(n(y),!y.show_seller_profile){o(!1);return}let K=k.from("items").select("id, title, price, image_url, status",{count:"exact"}).eq("user_id",c).eq("status","published");d&&(K=K.neq("id",d));const{data:Y,error:J,count:D}=await K.order("created_at",{ascending:!1}).limit(4);if(J)throw J;u(Y||[]),z(D||0)}catch(y){console.error("Error fetching seller data:",y)}finally{o(!1)}},A=y=>{const V=new Date(y),K=V.toLocaleDateString("de-DE",{month:"long"}),Y=V.getFullYear();return`${K} ${Y}`},P=y=>y?y.split(" ").map(V=>V[0]).join("").toUpperCase().slice(0,2):"U",H=()=>{s(`/?seller=${c}`)},X=y=>{s(`/item/${y}`)};return j?e.jsx(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Ue,{variant:"circular",width:60,height:60}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(Ue,{variant:"text",width:"60%",height:24}),e.jsx(Ue,{variant:"text",width:"40%",height:20})]})]})}):!p||!p.show_seller_profile?e.jsx(t,{sx:{p:2,bgcolor:"#f5f5f5",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Mt,{size:16,color:"#666"}),e.jsx(a,{variant:"body2",color:"text.secondary",fontWeight:500,children:"Privater Verkäufer"})]})}):e.jsxs(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:2,mb:3},children:[e.jsx(Lt,{src:p.avatar_url||void 0,sx:{width:60,height:60,bgcolor:"#1976d2",fontSize:"1.25rem",fontWeight:600},children:P(p.full_name)}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"h6",fontWeight:600,sx:{mb:.5},children:p.full_name||"Benutzer"}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Mitglied seit ",A(p.created_at)]}),b>0&&e.jsxs(a,{variant:"body2",color:"primary",fontWeight:500,sx:{mt:.5},children:[b," ",b===1?"aktives Inserat":"aktive Inserate"]})]})]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"subtitle2",fontWeight:600,sx:{mb:1.5},children:"Weitere Inserate"}),e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,mb:2,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3}},children:g.map(y=>e.jsxs(t,{onClick:()=>X(y.id),sx:{width:110,minWidth:110,maxWidth:110,flexShrink:0,cursor:"pointer",transition:"transform 0.2s","&:hover":{transform:"scale(1.05)"}},children:[e.jsx(t,{sx:{width:"100%",height:110,bgcolor:"#e0e0e0",borderRadius:1.5,overflow:"hidden",mb:.5},children:y.image_url?e.jsx("img",{src:y.image_url,alt:y.title,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(t,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5"},children:e.jsx(a,{variant:"caption",color:"text.secondary",children:"Kein Bild"})})}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.8rem",lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mb:.25,minHeight:"2.1em"},children:y.title}),e.jsxs(a,{variant:"body2",fontWeight:600,color:"primary",sx:{fontSize:"0.85rem"},children:[y.price.toFixed(2)," €"]})]},y.id))}),e.jsx(W,{variant:"outlined",onClick:H,endIcon:e.jsx(G,{size:18}),fullWidth:!0,sx:{textTransform:"none",borderRadius:1.5,py:1},children:"Alle Inserate anzeigen"})]})]})},Er=()=>{var fs,us,ms,bs,js,ys,_s,vs,ws,ks,Ss,zs,Cs,Is;const{id:c}=Pt(),d=Js(),p=Vt(),{user:n}=Ys(),{handPreference:g}=Bt(),{isFavorite:u,toggleFavorite:b,loading:z}=qt(),j=Qe(),o=Je(j.breakpoints.down("md")),[s,C]=h.useState(null),[A,P]=h.useState(!0),[H,X]=h.useState(""),[y,V]=h.useState(!1),[K,Y]=h.useState(!1),[J,D]=h.useState(null),[T,Te]=h.useState(null),[N,de]=h.useState(null),[Ee,he]=h.useState(!1),[M,re]=h.useState(0),Ne=h.useRef(!1),[ie,et]=h.useState(1),[st,tt]=h.useState(0),rt=h.useRef(null),[xe,it]=h.useState(!1),[at,ss]=h.useState(!1),[ts,pe]=h.useState([]),[ae,Ae]=h.useState(""),[nt,ge]=h.useState({}),[l,se]=h.useState(!1),[i,ne]=h.useState({}),[fe,rs]=h.useState(!1),[is,oe]=h.useState(!1),[ot,ue]=h.useState(!1),[lt,ct]=h.useState(!1),[dt,as]=h.useState(!1),ns=h.useRef(null),[ht,me]=h.useState(!1),{hasPermission:xt}=br(),[pt,be]=h.useState(!1),[je,os]=h.useState(""),[ls,cs]=h.useState(!1),[le,ce]=h.useState({open:!1,message:"",severity:"success"}),{status:gt}=mr({itemId:c||"",draftData:i,enabled:l&&is,debounceMs:1500}),v=((fs=p.state)==null?void 0:fs.allItems)||[],ee=v.findIndex(r=>r.id===c),B=ee>0,q=ee>=0&&ee<v.length-1,ds=()=>{const r=sessionStorage.getItem("returnSearch");r?(d(`/${r}`),sessionStorage.removeItem("returnSearch")):d("/")},hs=async r=>{var $,E;const x={},S=[];let F=r;const _=new Map;for(;F;){const{data:U}=await k.from("categories").select("id, translations, parent_id, level").eq("id",F).maybeSingle();if(!U)break;_.set(U.level,U.id);const Me=((E=($=U.translations)==null?void 0:$.de)==null?void 0:E.name)||"Unbekannt";S.unshift(Me),F=U.parent_id}return _.has(1)&&(x.level1=_.get(1)),_.has(2)&&(x.level2=_.get(2)),_.has(3)&&(x.level3=_.get(3)),_.has(4)&&(x.level4=_.get(4)),Ae(S.join(" › ")),x},R=h.useCallback(async r=>{const x=r==="prev"&&B?v[ee-1]:r==="next"&&q?v[ee+1]:null;if(!x)return;if(C(x),re(0),window.scrollTo(0,0),x.category_id){const _=await hs(x.category_id);ge(_)}else Ae(""),ge({});const{data:S}=await k.from("item_images").select("image_url, display_order, is_primary").eq("item_id",x.id).order("display_order",{ascending:!0});S&&S.length>0?pe(S.map(_=>_.image_url)):pe(x.image_url?[x.image_url]:[]);const{data:F}=await k.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",x.user_id).maybeSingle();if(Te(F),x.selected_address_id){const{data:_}=await k.from("addresses").select("*").eq("id",x.selected_address_id).maybeSingle();de(_)}else de(null);Ne.current=!0,d(`/item/${x.id}`,{state:{allItems:v},replace:!0})},[v,ee,B,q,d]),w=ts.length>0?ts:s!=null&&s.image_url?[s.image_url]:[],ye=()=>{re(r=>r===0?w.length-1:r-1)},_e=()=>{re(r=>r===w.length-1?0:r+1)},ft=Ls({onSwipedLeft:_e,onSwipedRight:ye,trackMouse:!1,trackTouch:!0}),ut=Ls({onSwipedLeft:()=>q&&R("next"),onSwipedRight:()=>B&&R("prev"),trackMouse:!1,trackTouch:!0});ur(s==null?void 0:s.id,!!s),h.useEffect(()=>{const r=()=>{it(window.scrollY>500)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const ve=()=>{window.scrollTo({top:0,behavior:"smooth"})},De=async()=>{if(c){if(Ne.current){Ne.current=!1;return}P(!0);try{const{data:r,error:x}=await k.from("items").select("*").eq("id",c).maybeSingle();if(x)throw x;if(!r){d("/");return}if(r.status==="draft"&&(!n||n.id!==r.user_id)){d("/");return}r.vehicle_brand||r.vehicle_year||r.vehicle_mileage?console.log("[Vehicle Attributes] Loaded from database:",{vehicle_brand:r.vehicle_brand,vehicle_year:r.vehicle_year,vehicle_mileage:r.vehicle_mileage,vehicle_fuel_type:r.vehicle_fuel_type,vehicle_color:r.vehicle_color,vehicle_power_kw:r.vehicle_power_kw,vehicle_first_registration:r.vehicle_first_registration,vehicle_tuv_until:r.vehicle_tuv_until}):console.log("[Vehicle Attributes] No vehicle attributes found in loaded item"),C(r);let S={};if(r.category_id?(S=await hs(r.category_id),ge(S)):(Ae(""),ge({})),n&&n.id===r.user_id){if(r.status==="draft"){if(r.draft_data){const we=r.draft_data.category,_t=we&&typeof we=="object"&&!Array.isArray(we)?we:S;ne({...r.draft_data,category:_t})}se(!0),oe(!0);const{count:E}=await k.from("items").select("*",{count:"exact",head:!0}).eq("user_id",n.id).neq("status","draft"),U=E===0;ct(U);const Me=localStorage.getItem("hasSeenItemEditOnboarding");U&&!Me&&setTimeout(()=>{as(!0)},800)}else if(r.has_draft&&r.draft_data){const E=r.draft_data.category,U=E&&typeof E=="object"&&!Array.isArray(E)?E:S;ne({...r.draft_data,category:U}),oe(!0),se(!0)}}const{data:F}=await k.from("item_images").select("image_url, display_order, is_primary").eq("item_id",c).order("display_order",{ascending:!0});F&&F.length>0?pe(F.map(E=>E.image_url)):pe(r.image_url?[r.image_url]:[]);const{data:_,error:$}=await k.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",r.user_id).maybeSingle();if($)throw $;if(Te(_),r.selected_address_id){const{data:E}=await k.from("addresses").select("*").eq("id",r.selected_address_id).maybeSingle();de(E)}else de(null)}catch(r){console.error("Error loading item:",r),d("/")}finally{P(!1)}}};h.useEffect(()=>{De()},[c,d]),h.useEffect(()=>(s!=null&&s.title&&(document.title=s.title),()=>{document.title="Bazar - Dein Online-Flohmarkt"}),[s==null?void 0:s.title]);const f=(r,x)=>{ne(S=>({...S,[r]:x})),oe(!0)},xs=async()=>{if(!(!s||!c)){rs(!0);try{const{images:r,category:x,...S}=i;let F=s.category_id;if(x&&typeof x=="object"){const E=Gt(x);E&&(F=E)}const _={...S,category_id:F,status:s.status==="draft"?"published":s.status,has_draft:!1,draft_data:null,draft_updated_at:null,updated_at:new Date().toISOString()},{error:$}=await k.from("items").update(_).eq("id",c);if($)throw $;C({...s,...S}),se(!1),oe(!1),ne({}),await De()}catch(r){console.error("Error publishing:",r),D("Fehler beim Veröffentlichen der Änderungen")}finally{rs(!1)}}},mt=async()=>{if(c)try{await k.from("items").update({has_draft:!1,draft_data:null,draft_updated_at:null}).eq("id",c),se(!1),oe(!1),ne({})}catch(r){console.error("Error canceling edit:",r)}},bt=async()=>{if(!je.trim()){ce({open:!0,message:"Bitte gib einen Grund für die Ablehnung an",severity:"error"});return}cs(!0);try{const{error:r}=await k.rpc("reject_item",{item_id:c,reason:je});if(r)throw r;ce({open:!0,message:"Inserat wurde abgelehnt",severity:"success"}),be(!1),os(""),await De()}catch(r){ce({open:!0,message:`Fehler: ${r.message}`,severity:"error"})}finally{cs(!1)}};h.useEffect(()=>{window.scrollTo(0,0),re(0)},[s==null?void 0:s.id]),h.useEffect(()=>{if(!o)return;const r=()=>{const x=window.scrollY,F=Math.max(0,1-x/600),_=-(x*.05);et(F),tt(_)};return window.addEventListener("scroll",r,{passive:!0}),()=>window.removeEventListener("scroll",r)},[o]),h.useEffect(()=>{const r=x=>{if(!(x.target instanceof HTMLInputElement||x.target instanceof HTMLTextAreaElement)&&!Ee)switch(x.key){case"ArrowLeft":B&&(x.preventDefault(),R("prev"));break;case"ArrowRight":q&&(x.preventDefault(),R("next"));break;case"ArrowUp":B&&(x.preventDefault(),R("prev"));break;case"ArrowDown":q&&(x.preventDefault(),R("next"));break}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[B,q,Ee,R]);const ps=async()=>{s&&await b(s.id)},I=()=>{},gs=()=>{ss(!0)},jt=()=>{ss(!1)},yt=async()=>{if(!n){alert("Bitte melde dich an, um eine Nachricht zu senden.");return}if(!H.trim()||!s){D("Bitte gib eine Nachricht ein.");return}if(n.id===s.user_id){D("Du kannst dir selbst keine Nachricht senden.");return}V(!0),D(null);try{const{data:r,error:x}=await k.from("conversations").select("id").eq("item_id",s.id).eq("buyer_id",n.id).eq("seller_id",s.user_id).maybeSingle();if(x&&x.code!=="PGRST116")throw x;let S;if(r)S=r.id;else{const{data:_,error:$}=await k.from("conversations").insert({item_id:s.id,buyer_id:n.id,seller_id:s.user_id}).select("id").single();if($)throw $;S=_.id}const{error:F}=await k.from("messages").insert({conversation_id:S,sender_id:n.id,content:H.trim()});if(F)throw F;X(""),Y(!0),setTimeout(()=>Y(!1),3e3)}catch(r){console.error("Error sending message:",r),D("Fehler beim Senden der Nachricht. Bitte versuche es erneut.")}finally{V(!1)}};return A?e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:e.jsx(Rs,{})}):s?e.jsxs(t,{sx:{minHeight:"100vh",bgcolor:"#fafafa"},children:[e.jsxs(t,{className:"print-only",sx:{display:"none"},children:[e.jsx(t,{className:"print-header",children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx(t,{children:e.jsx("img",{src:"/logo.png",alt:"HABDAWAS Logo",className:"print-logo"})}),e.jsx(t,{sx:{textAlign:"right",fontSize:"8pt",color:"#666"},children:e.jsxs(a,{variant:"caption",sx:{display:"block",fontSize:"8pt"},children:["Gedruckt: ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})}),e.jsx(t,{className:"print-main-section",children:e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(t,{className:"print-image-container",children:w.slice(0,1).map((r,x)=>e.jsx("img",{src:r,alt:s.title,className:"print-main-image"},x))}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{className:"print-title",children:s.title}),e.jsxs(t,{className:"print-price-box",children:[s.price.toFixed(2)," €"]})]})]})}),e.jsxs(t,{className:"print-details-grid",children:[(s.postal_code||s.location)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📍 Standort:"}),e.jsx(t,{className:"print-detail-value",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),s.condition&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✨ Zustand:"}),e.jsx(t,{className:"print-detail-value",children:Fs(s.condition)})]}),s.brand&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🏷️ Marke:"}),e.jsx(t,{className:"print-detail-value",children:s.brand})]}),ae&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📦 Kategorie:"}),e.jsx(t,{className:"print-detail-value",children:ae})]}),s.shipping_cost!==null&&s.shipping_cost!==void 0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🚚 Versandkosten:"}),e.jsx(t,{className:"print-detail-value",children:s.shipping_cost===0?"Kostenloser Versand":`${s.shipping_cost.toFixed(2)} €`})]}),s.size&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📏 Größe:"}),e.jsx(t,{className:"print-detail-value",children:s.size})]}),(s.dimensions_length||s.dimensions_width||s.dimensions_height)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📐 Abmessungen:"}),e.jsx(t,{className:"print-detail-value",children:s.dimensions_length&&s.dimensions_width&&s.dimensions_height?`${s.dimensions_length} × ${s.dimensions_width} × ${s.dimensions_height} cm`:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")+" cm"})]}),s.weight&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"⚖️ Gewicht:"}),e.jsx(t,{className:"print-detail-value",children:s.weight})]}),s.quantity&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Verfügbare Menge:"}),e.jsx(t,{className:"print-detail-value",children:s.quantity})]}),s.colors&&s.colors.length>0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🎨 Farben:"}),e.jsx(t,{className:"print-detail-value",children:s.colors.join(", ")})]}),s.material&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🧵 Material:"}),e.jsx(t,{className:"print-detail-value",children:s.material})]}),s.style&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✂️ Stil:"}),e.jsx(t,{className:"print-detail-value",children:s.style})]}),s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔖 Seriennummer:"}),e.jsx(t,{className:"print-detail-value",children:s.serial_number})]}),s.item_number&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Artikelnummer:"}),e.jsx(t,{className:"print-detail-value",children:s.item_number})]})]}),s.description&&e.jsxs(t,{className:"print-description-box",children:[e.jsx("span",{className:"print-section-title",children:"📝 Beschreibung:"}),e.jsx(a,{className:"print-description-text",children:s.description})]}),(((us=s.features)==null?void 0:us.length)>0||((ms=s.accessories)==null?void 0:ms.length)>0)&&e.jsxs(t,{className:"print-extra-box",children:[((bs=s.features)==null?void 0:bs.length)>0&&e.jsxs(t,{sx:{mb:1},children:[e.jsx("span",{className:"print-section-title",children:"⭐ Merkmale:"})," ",s.features.join(" • ")]}),((js=s.accessories)==null?void 0:js.length)>0&&e.jsxs(t,{children:[e.jsx("span",{className:"print-section-title",children:"🎁 Zubehör:"})," ",s.accessories.join(" • ")]})]}),T&&e.jsxs(t,{className:"print-contact-section",children:[e.jsx(t,{className:"print-section-title",children:"📞 Kontakt zum Anbieter:"}),e.jsxs(t,{sx:{fontSize:"8.5pt",lineHeight:1.5},children:[T.full_name&&e.jsxs(t,{children:[e.jsx("strong",{children:"Name:"})," ",T.full_name,T.phone_verified&&e.jsx(Z,{icon:e.jsx(Oe,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{ml:1,height:20}})]}),(N==null?void 0:N.phone)&&(N==null?void 0:N.show_phone_publicly)&&e.jsxs(t,{children:[e.jsx("strong",{children:"Telefon:"})," ",N.phone]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Nachricht:"})," Über HABDAWAS.at Nachrichten-System"]})]})]}),e.jsx(t,{className:"print-footer",children:e.jsxs(a,{variant:"caption",sx:{fontSize:"7pt"},children:["HABDAWAS.at • Hollenthon 33, 2812 Hollenthon • +43 650 25 26 266 • ID: ",s.id.slice(0,10)]})})]}),s&&e.jsx(xr,{open:at,onClose:jt,url:window.location.href,title:s.title,price:s.price}),!o&&v.length>0&&e.jsx(t,{sx:{position:"fixed",top:72,left:0,right:0,zIndex:100,bgcolor:"white",borderBottom:"1px solid",borderColor:"divider",py:1.5},children:e.jsx(Ts,{maxWidth:"lg",children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,height:48},children:[e.jsx(W,{variant:"text",startIcon:e.jsx(O,{size:18}),onClick:ds,sx:{textTransform:"none",fontSize:"14px",fontWeight:500,px:2,height:40,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:"Zurück"}),(n==null?void 0:n.id)===s.user_id&&e.jsx(e.Fragment,{children:e.jsx(W,{variant:l?"contained":"outlined",startIcon:e.jsx(Le,{size:18}),onClick:()=>se(!l),sx:{textTransform:"none",fontSize:"14px",fontWeight:600,px:2.5,height:40,borderRadius:2,boxShadow:l?1:0},children:"Bearbeiten"})}),xt("items.reject")&&s.status==="published"&&e.jsx(W,{variant:"outlined",color:"error",startIcon:e.jsx(er,{size:18}),onClick:()=>be(!0),disabled:ls,sx:{textTransform:"none",fontSize:"14px",fontWeight:600,px:2.5,height:40,borderRadius:2},children:"Sperren"}),(n==null?void 0:n.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,px:2,py:.75,borderRadius:2,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(a,{sx:{fontSize:"13px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(m,{onClick:()=>ue(!0),sx:{color:"text.secondary",height:40,width:40,"&:hover":{bgcolor:"rgba(211, 47, 47, 0.08)",color:"error.main"}},children:e.jsx($t,{size:18})})]}),e.jsx(t,{sx:{flex:1}}),e.jsx(m,{onClick:ps,disabled:!n||z,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:s&&u(s.id)?e.jsx(Ie,{size:20,fill:"currentColor"}):e.jsx(Ie,{size:20})}),e.jsx(m,{onClick:gs,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:e.jsx(Fe,{size:20})}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,height:40,px:1.5,borderRadius:2,bgcolor:"rgba(0, 0, 0, 0.04)"},children:[e.jsx(m,{onClick:()=>R("prev"),disabled:!B,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx(O,{size:20})}),e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{minWidth:50,textAlign:"center",fontSize:"14px",fontWeight:500},children:[ee+1," / ",v.length]}),e.jsx(m,{onClick:()=>R("next"),disabled:!q,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx(G,{size:20})})]})]})})}),e.jsxs(Ts,{maxWidth:"lg",sx:{py:o?2:3,px:o?0:3,pt:!o&&v.length>0?14:o?2:3},children:[n&&s&&n.id===s.user_id&&s.status==="published"&&s.has_draft&&e.jsxs(t,{sx:{mb:3,p:3,borderRadius:3,border:"2px solid",borderColor:"warning.main",bgcolor:"rgba(237, 108, 2, 0.04)",display:"flex",alignItems:"center",gap:3,flexDirection:o?"column":"row"},children:[e.jsx(t,{sx:{width:48,height:48,borderRadius:3,bgcolor:"warning.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(Le,{size:24,color:"white"})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:700,mb:.5,fontSize:"1.1rem"},children:"Unveröffentlichte Änderungen"}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6},children:"Du hast Änderungen vorgenommen, die noch nicht veröffentlicht wurden. Übernimm die Änderungen, damit sie für andere sichtbar werden."})]}),e.jsx(W,{size:"large",variant:"contained",color:"warning",onClick:xs,disabled:fe,startIcon:fe?e.jsx(Rs,{size:18,color:"inherit"}):e.jsx(Qs,{size:20}),sx:{minWidth:180,height:48,borderRadius:3,textTransform:"none",fontSize:"1rem",fontWeight:600,boxShadow:2,"&:hover":{boxShadow:4},flexShrink:0},children:fe?"Wird aktualisiert...":"Änderungen übernehmen"})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:o?"column":"row",gap:o?0:2},children:[!o&&e.jsx(t,{sx:{flex:"1 1 40%",position:"sticky",top:v.length>0?160:80,alignSelf:"flex-start",maxHeight:v.length>0?"calc(100vh - 260px)":"calc(100vh - 180px)",display:"flex",flexDirection:"column",gap:2},children:(n==null?void 0:n.id)===s.user_id&&l?e.jsxs(t,{sx:{position:"relative"},children:[e.jsx(Ps,{images:i.images||w.map(r=>({preview:r,existingUrl:r,isPrimary:r===w[0]})),onChange:r=>f("images",r),isEditing:l}),e.jsx(m,{onClick:()=>me(!0),sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:10},children:e.jsx(Es,{size:20})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{position:"relative",width:"100%",height:w.length>1?"calc(100% - 120px)":"100%",bgcolor:"#f5f5f5",borderRadius:2,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:3},onClick:()=>he(!0),children:[e.jsx(t,{component:"img",src:Pe(w[M]),alt:s.title,loading:"lazy",sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transition:"opacity 0.3s ease-in-out"}}),w.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(m,{onClick:r=>{r.stopPropagation(),ye()},disabled:M===0,sx:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx(O,{})}),e.jsx(m,{onClick:r=>{r.stopPropagation(),_e()},disabled:M===w.length-1,sx:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx(G,{})}),e.jsxs(t,{sx:{position:"absolute",top:12,right:12,bgcolor:"rgba(0,0,0,0.65)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20},children:[M+1," / ",w.length]})]})]}),w.length>1&&e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-track":{bgcolor:"#f5f5f5",borderRadius:3},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3,"&:hover":{bgcolor:"#999"}}},children:w.map((r,x)=>e.jsxs(t,{onClick:()=>re(x),sx:{minWidth:100,width:100,height:100,borderRadius:1.5,overflow:"hidden",cursor:"pointer",border:M===x?"3px solid #1976d2":"3px solid transparent",opacity:M===x?1:.6,transition:"all 0.2s ease",position:"relative","&:hover":{opacity:1,transform:"scale(1.05)"}},children:[e.jsx(t,{component:"img",src:Pe(r),alt:`${s.title} - Vorschau ${x+1}`,loading:"lazy",sx:{width:"100%",height:"100%",objectFit:"cover"}}),x===0&&e.jsx(t,{sx:{position:"absolute",top:4,left:4,bgcolor:"primary.main",color:"white",px:.75,py:.25,borderRadius:1,fontSize:"0.65rem",fontWeight:700,textTransform:"uppercase"},children:"Haupt"})]},x))})]})}),e.jsxs(t,{...o&&v.length>0?ut:{},sx:{flex:o?"1":"1 1 60%",bgcolor:"white",borderRadius:2,overflow:"visible",maxHeight:"none",mt:o?"-55px":0},children:[o&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{...ft,sx:{position:"fixed",top:55,left:0,right:0,width:"100%",height:"400px",bgcolor:"#f5f5f5",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",overflow:"hidden",zIndex:1},onClick:()=>he(!0),children:[e.jsx(t,{component:"img",src:Pe(w[M]),alt:s.title,loading:"lazy",sx:{width:"100%",height:"100%",display:"block",objectFit:"cover",objectPosition:"center",transform:`translateY(${st}px)`,opacity:ie,transition:"opacity 0.1s ease-out",willChange:"transform, opacity"}}),(n==null?void 0:n.id)===s.user_id&&l&&e.jsx(m,{onClick:r=>{r.stopPropagation(),me(!0)},sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:20,opacity:ie,transition:"opacity 0.1s ease-out"},children:e.jsx(Es,{size:20})}),w.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(m,{onClick:r=>{r.stopPropagation(),ye()},disabled:M===0,sx:{position:"absolute",left:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:ie,transition:"opacity 0.1s ease-out"},children:e.jsx(O,{})}),e.jsx(m,{onClick:r=>{r.stopPropagation(),_e()},disabled:M===w.length-1,sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:ie,transition:"opacity 0.1s ease-out"},children:e.jsx(G,{})}),e.jsxs(t,{sx:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.6)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20,opacity:ie,transition:"opacity 0.1s ease-out"},children:[M+1," / ",w.length]})]})]}),v.length===0&&e.jsx(t,{sx:{height:{xs:"400px",md:"400px"}}}),v.length>0&&e.jsx(t,{sx:{height:{xs:"400px",md:"400px"}}}),e.jsxs(t,{sx:{position:"sticky",top:55,left:0,right:0,width:"100%",bgcolor:"white",borderBottom:"1px solid #e0e0e0",zIndex:100,px:2,py:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(W,{variant:"text",startIcon:e.jsx(O,{size:18}),onClick:ds,sx:{textTransform:"none",fontWeight:600,color:"text.secondary",fontSize:"0.9375rem",px:0,bgcolor:"rgba(0, 0, 0, 0.02)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)",color:"primary.main"}},children:"Zurück zur Liste"}),e.jsxs(t,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(n==null?void 0:n.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5,px:1.25,py:.4,borderRadius:1.5,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:5,height:5,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(a,{sx:{fontSize:"10px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(m,{onClick:()=>se(!l),size:"small",sx:{color:l?"primary.main":"text.primary",bgcolor:l?"rgba(25, 118, 210, 0.08)":"transparent","&:hover":{bgcolor:l?"rgba(25, 118, 210, 0.12)":"rgba(0,0,0,0.04)"}},children:e.jsx(Le,{size:18})})]}),e.jsx(m,{onClick:ps,disabled:!n||z,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:s&&u(s.id)?e.jsx(Ie,{size:18,fill:"currentColor"}):e.jsx(Ie,{size:18})}),e.jsx(m,{onClick:gs,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:e.jsx(Fe,{size:18})})]})]})]}),e.jsxs(t,{sx:{p:o?2:3,px:o?2:3,maxWidth:800,bgcolor:"white",borderRadius:0,position:"relative",zIndex:10},children:[e.jsx(t,{ref:ns,sx:{mb:o?1:3},children:e.jsx(L,{value:i.title||s.title,isEditing:l,onChange:r=>f("title",r),onSave:I,variant:o?"h5":"h4",placeholder:"Artikeltitel"})}),e.jsxs(t,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",mb:1.5},children:[(s.postal_code||s.location)&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Ve,{size:18,color:"#666"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(qs,{size:18,color:"#666"}),e.jsx(a,{variant:"body2",color:"text.secondary",children:Ht(s.created_at)})]})]}),e.jsx(t,{sx:{mb:o?1.5:3},children:l?e.jsxs(t,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:1.5},children:(i.is_free!==void 0?i.is_free:s.is_free)?e.jsx(a,{variant:o?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Zu verschenken"}):(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?e.jsx(a,{variant:o?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Auf Anfrage"}):e.jsxs(e.Fragment,{children:[e.jsx(L,{value:String(i.price!==void 0?i.price:s.price),isEditing:l,onChange:r=>f("price",parseFloat(r)||0),onSave:I,type:"number",variant:o?"h4":"h3",placeholder:"0.00",displayValue:`${parseFloat(String(i.price!==void 0?i.price:s.price)).toFixed(2)} €`,displayColor:"primary.main"}),(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(Z,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})}),e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap",mt:1,alignItems:"center"},children:[e.jsxs(t,{onClick:()=>{const r=!(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable);f("price_negotiable",r),r&&(f("is_free",!1),f("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"not-allowed":"pointer",opacity:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?.5:1,userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(a,{variant:"body1",sx:{color:"text.primary"},children:"VB"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.is_free!==void 0?i.is_free:s.is_free);f("is_free",r),r&&(f("price_negotiable",!1),f("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.is_free!==void 0?i.is_free:s.is_free)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(a,{variant:"body1",sx:{color:"text.primary"},children:"Gratis"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.price_on_request!==void 0?i.price_on_request:s.price_on_request);f("price_on_request",r),r&&(f("is_free",!1),f("price_negotiable",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(a,{variant:"body1",sx:{color:"text.primary"},children:"Auf Anfrage"})]})]})]}):e.jsx(t,{children:e.jsxs(a,{variant:o?"h4":"h3",color:"primary.main",fontWeight:"bold",children:[s.is_free?"Zu verschenken":s.price_on_request?"Auf Anfrage":`${s.price.toFixed(2)} €`,s.price_negotiable&&!s.is_free&&!s.price_on_request&&e.jsx(Z,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})})}),e.jsx(Q,{sx:{my:o?2:3}}),e.jsx(a,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Beschreibung"}),e.jsx(L,{value:i.description||s.description,isEditing:l,onChange:r=>f("description",r),onSave:I,multiline:!0,rows:12,placeholder:"Artikelbeschreibung"}),(ae||s.brand||s.condition||s.size||s.weight||s.dimensions_length||s.material||((ys=s.colors)==null?void 0:ys.length)||s.style||((_s=s.features)==null?void 0:_s.length)||((vs=s.accessories)==null?void 0:vs.length)||s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt")&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{sx:{my:o?2:3}}),e.jsx(a,{variant:"h6",sx:{mb:3,fontWeight:600},children:"Produktdetails"}),e.jsxs(t,{sx:{display:"grid",gap:2},children:[(ae||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#2196f3":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Ut,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(Jt,{value:i.category||nt,onChange:r=>f("category",r),required:!0,showBreadcrumbs:!0}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Kategorie"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:ae})]})})]}),s.condition&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:"grey.200"},children:[e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(Be,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Zustand"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:Fs(s.condition)})]})]}),s.brand&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:"grey.200"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Be,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Marke"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500,textTransform:"uppercase"},children:s.brand})]})]}),(s.size&&s.size.toLowerCase()!=="unbekannt"||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(Vs,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(L,{value:i.size||s.size||"",isEditing:l,onSave:I,onChange:r=>f("size",r),label:"Größe",placeholder:"z.B. XL, 42, 180cm"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Größe"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.size})]})})]}),(s.weight&&s.weight.toLowerCase()!=="unbekannt"||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"warning.main"},children:e.jsx(Xt,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(L,{value:i.weight||s.weight||"",isEditing:l,onSave:I,onChange:r=>f("weight",r),label:"Gewicht",placeholder:"z.B. 500g, 2kg"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Gewicht"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.weight})]})})]}),(s.dimensions_length||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(Yt,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsxs(t,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(L,{value:i.dimensions_length||s.dimensions_length||"",isEditing:l,onSave:I,onChange:r=>f("dimensions_length",r),label:"Länge (cm)",placeholder:"Länge"}),e.jsx(L,{value:i.dimensions_width||s.dimensions_width||"",isEditing:l,onSave:I,onChange:r=>f("dimensions_width",r),label:"Breite (cm)",placeholder:"Breite"}),e.jsx(L,{value:i.dimensions_height||s.dimensions_height||"",isEditing:l,onSave:I,onChange:r=>f("dimensions_height",r),label:"Höhe (cm)",placeholder:"Höhe"})]}):s.dimensions_length&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Abmessungen"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")})]})})]}),(s.material&&s.material.toLowerCase()!=="unbekannt"||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"secondary.main"},children:e.jsx(Ge,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(L,{value:i.material||s.material||"",isEditing:l,onSave:I,onChange:r=>f("material",r),label:"Material",placeholder:"z.B. Baumwolle, Holz, Metall"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Material"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.material})]})})]}),(s.style&&s.style.toLowerCase()!=="unbekannt"||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Be,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(L,{value:i.style||s.style||"",isEditing:l,onSave:I,onChange:r=>f("style",r),label:"Stil",placeholder:"z.B. Modern, Vintage, Klassisch"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Stil"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.style})]})})]}),(((ws=s.colors)==null?void 0:ws.length)>0||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"error.main"},children:e.jsx(Ns,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(Re,{value:i.colors||s.colors||[],isEditing:l,onSave:I,onChange:r=>f("colors",r),label:"Farben",placeholder:"Farbe hinzufügen",color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Farben"}),e.jsx(t,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:1},children:(ks=s.colors)==null?void 0:ks.map((r,x)=>e.jsx(Z,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"primary.50",color:"primary.dark",border:1,borderColor:"primary.200"}},x))})]})})]}),(((Ss=s.features)==null?void 0:Ss.length)>0||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#e8f5e9":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#4caf50":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(Ge,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(Re,{value:i.features||s.features||[],isEditing:l,onSave:I,onChange:r=>f("features",r),label:"Eigenschaften",placeholder:"Eigenschaft hinzufügen",color:"success"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Eigenschaften"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:(zs=s.features)==null?void 0:zs.map((r,x)=>e.jsx(Z,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"success.50",color:"success.dark",border:1,borderColor:"success.200"}},x))})]})})]}),(((Cs=s.accessories)==null?void 0:Cs.length)>0||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#2196f3":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(qe,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(Re,{value:i.accessories||s.accessories||[],isEditing:l,onSave:I,onChange:r=>f("accessories",r),label:"Zubehör",placeholder:"Zubehör hinzufügen",color:"info"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Zubehör"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:s.accessories.map((r,x)=>e.jsx(Z,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"info.50",color:"info.dark",border:1,borderColor:"info.200"}},x))})]})})]}),(s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"||l)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:l?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:l?"#ff9800":"grey.200"},children:[!l&&e.jsx(t,{sx:{mt:.25,color:"grey.600"},children:e.jsx(Zt,{size:20})}),e.jsx(t,{sx:{flex:1},children:l?e.jsx(L,{value:i.serial_number||s.serial_number||"",isEditing:l,onSave:I,onChange:r=>f("serial_number",r),label:"Seriennummer",placeholder:"Seriennummer oder Artikelnummer"}):e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Seriennummer"}),e.jsx(a,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.95rem",color:"text.primary",fontWeight:500},children:s.serial_number})]})})]})]})]}),(s.vehicle_brand||s.vehicle_year||s.vehicle_mileage||s.vehicle_fuel_type||s.vehicle_color||s.vehicle_power_kw||s.vehicle_first_registration||s.vehicle_tuv_until)&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{sx:{my:o?2:3}}),e.jsxs(a,{variant:"h6",sx:{mb:3,fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(As,{size:24,style:{color:"#1976d2"}}),"Fahrzeug-Daten"]}),e.jsxs(t,{sx:{display:"grid",gap:2},children:[s.vehicle_brand&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(As,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Fahrzeugmarke"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500,textTransform:"uppercase"},children:s.vehicle_brand})]})]}),s.vehicle_year&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(qs,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Baujahr"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.vehicle_year})]})]}),s.vehicle_fuel_type&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(hr,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Kraftstoffart"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500,textTransform:"capitalize"},children:s.vehicle_fuel_type})]})]}),s.vehicle_power_kw&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Ot,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Leistung"}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.vehicle_power_kw," kW (",Math.round(s.vehicle_power_kw*1.36)," PS)"]})]})]}),s.vehicle_first_registration&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(dr,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Erstzulassung"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:new Date(s.vehicle_first_registration).toLocaleDateString("de-DE",{year:"numeric",month:"long",day:"numeric"})})]})]}),s.vehicle_color&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Ns,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Fahrzeugfarbe"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500,textTransform:"capitalize"},children:s.vehicle_color})]})]}),s.vehicle_mileage&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Vs,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Kilometerstand"}),e.jsxs(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.vehicle_mileage.toLocaleString("de-DE")," km"]})]})]}),s.vehicle_tuv_until&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:"#f0f7ff",borderRadius:2,border:"1px solid #90caf9"},children:[e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Oe,{size:20})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"TÜV bis"}),e.jsx(a,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:new Date(s.vehicle_tuv_until).toLocaleDateString("de-DE",{year:"numeric",month:"long"})})]})]})]})]}),(((Is=s.tags)==null?void 0:Is.length)>0||l)&&e.jsxs(t,{sx:{mt:3,mb:3},children:[e.jsx(a,{variant:"subtitle2",color:"text.secondary",sx:{fontWeight:600,mb:1},children:"Tags"}),l?e.jsx(Re,{value:i.tags||s.tags||[],isEditing:l,onSave:I,onChange:r=>f("tags",r),placeholder:"Tag hinzufügen und Enter drücken"}):e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:s.tags.map((r,x)=>e.jsx(Z,{label:`#${r}`,size:"small",variant:"filled"},x))})]}),e.jsx(Q,{sx:{my:o?2:3}}),(s.snapshot_shipping_enabled||s.snapshot_pickup_enabled||l)&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Versand & Abholung"}),l?e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Ve,{size:o?18:20,color:"#1976d2"}),e.jsx(Ds,{control:e.jsx(Ms,{checked:i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled,onChange:r=>f("snapshot_pickup_enabled",r.target.checked)}),label:e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"}),sx:{m:0}})]}),(i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:1},children:n&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[s.snapshot_pickup_address,e.jsx("br",{}),s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]}):e.jsx(e.Fragment,{children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"})}),e.jsx(L,{value:i.snapshot_location_description!==void 0?i.snapshot_location_description:s.snapshot_location_description||"",isEditing:l,onChange:r=>f("snapshot_location_description",r),onSave:I,placeholder:"Optionale Beschreibung zur Abholung",label:"Abholbeschreibung"})]})]}),e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx($e,{size:o?18:20,color:"#1976d2"}),e.jsx(Ds,{control:e.jsx(Ms,{checked:i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled,onChange:r=>f("snapshot_shipping_enabled",r.target.checked)}),label:e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"}),sx:{m:0}})]}),(i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(Qt,{value:i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type||"fixed",isEditing:l,onChange:r=>f("snapshot_shipping_cost_type",r),onSave:I,options:[{value:"free",label:"Kostenloser Versand"},{value:"fixed",label:"Feste Versandkosten"},{value:"ai_calculated",label:"KI-berechnet"}],label:"Versandkostentyp"}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="fixed"&&e.jsx(t,{sx:{mt:1},children:e.jsx(L,{value:String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0),isEditing:l,onChange:r=>f("snapshot_shipping_cost",parseFloat(r)||0),onSave:I,type:"number",placeholder:"0.00",label:"Versandkosten (€)",displayValue:`${parseFloat(String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0)).toFixed(2)} €`})}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mt:1.5,p:1.5,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(qe,{size:16,color:"#f57c00"}),e.jsx(a,{variant:"body2",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(a,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(a,{variant:"caption",color:"text.secondary",sx:{display:"block",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]})]}),e.jsx(t,{sx:{mt:1},children:e.jsx(L,{value:i.snapshot_shipping_description!==void 0?i.snapshot_shipping_description:s.snapshot_shipping_description||"",isEditing:l,onChange:r=>f("snapshot_shipping_description",r),onSave:I,placeholder:"Optionale Versandbeschreibung",label:"Versandbeschreibung"})})]})]})]}):e.jsxs(e.Fragment,{children:[s.snapshot_pickup_enabled&&e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ve,{size:o?18:20,color:"#1976d2"}),e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"})]}),n&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",children:s.snapshot_pickup_address}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:[s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]})]}):e.jsx(a,{variant:"body2",color:"text.secondary",children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"}),s.snapshot_location_description&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_location_description})]}),s.snapshot_shipping_enabled&&e.jsxs(e.Fragment,{children:[s.snapshot_shipping_cost_type==="free"&&e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx($e,{size:o?18:20,color:"#1976d2"}),e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsx(a,{variant:"body2",color:"text.secondary",children:"Versandkosten: Kostenlos"}),s.snapshot_shipping_description&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="fixed"&&e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx($e,{size:o?18:20,color:"#1976d2"}),e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsxs(a,{variant:"body2",color:"text.secondary",children:["Versandkosten: ",s.snapshot_shipping_cost&&s.snapshot_shipping_cost>0?`${s.snapshot_shipping_cost.toFixed(2)} €`:"Auf Anfrage"]}),s.snapshot_shipping_description&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mb:2,p:o?1.5:2,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(qe,{size:o?18:20,color:"#f57c00"}),e.jsx(a,{variant:o?"body1":"subtitle1",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{mt:1,fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(a,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]}),e.jsx(a,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1.5,fontSize:"0.75rem"},children:"ⓘ Diese Versandkosten wurden automatisch von der KI basierend auf Größe und Gewicht geschätzt."}),s.snapshot_shipping_description&&e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mt:1.5,fontStyle:"italic"},children:s.snapshot_shipping_description})]})]})]}),e.jsx(Q,{sx:{my:o?2:3}})]}),!l&&s.user_id&&e.jsx(t,{sx:{mb:o?2:3},children:e.jsx(_r,{userId:s.user_id,currentItemId:s.id})}),e.jsxs(t,{sx:{bgcolor:"#f0f7ff",p:o?2:3,borderRadius:2,mb:o?2:3,border:"1px solid #e3f2fd"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(a,{variant:"h6",sx:{fontWeight:600},children:"Verkäufer kontaktieren"}),(T==null?void 0:T.phone_verified)&&e.jsx(Z,{icon:e.jsx(Oe,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{height:24}})]}),e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:2,lineHeight:1.6},children:"Interesse an diesem Artikel? Kontaktiere den Verkäufer für weitere Informationen oder um einen Kauf zu vereinbaren."}),(N==null?void 0:N.phone)&&(N==null?void 0:N.show_phone_publicly)&&e.jsxs(t,{sx:{mb:2,p:1.5,bgcolor:"white",borderRadius:1,border:"1px solid #e3f2fd",display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main",color:"white",borderRadius:"50%",width:36,height:36,flexShrink:0},children:e.jsx(sr,{size:18})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.25},children:"Telefon"}),e.jsx(a,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:e.jsx("a",{href:`tel:${N.phone}`,style:{color:"inherit",textDecoration:"none"},children:N.phone})})]})]}),K&&e.jsx(te,{severity:"success",sx:{mb:2},children:"Nachricht erfolgreich gesendet!"}),J&&e.jsx(te,{severity:"error",sx:{mb:2},onClose:()=>D(null),children:J}),!n&&e.jsx(te,{severity:"info",sx:{mb:2},children:"Bitte melde dich an, um den Verkäufer zu kontaktieren."}),n&&n.id===s.user_id&&e.jsx(te,{severity:"info",sx:{mb:0},children:"Dies ist dein eigenes Inserat."}),n&&n.id!==s.user_id&&e.jsxs(e.Fragment,{children:[e.jsx(Ke,{fullWidth:!0,multiline:!0,rows:3,placeholder:"Schreibe eine Nachricht an den Verkäufer...",value:H,onChange:r=>X(r.target.value),sx:{mb:2,bgcolor:"white"},disabled:!n,inputRef:rt}),e.jsx(W,{variant:"contained",size:"large",fullWidth:!0,onClick:yt,disabled:!n||!H.trim()||y,startIcon:e.jsx(tr,{size:18}),children:y?"Wird gesendet...":"Nachricht senden"})]})]}),e.jsxs(a,{variant:"caption",color:"text.disabled",sx:{display:"block",fontSize:o?"0.7rem":"0.75rem"},children:["Inserat-ID: ",s.id.slice(0,8),o&&e.jsx("br",{})," • Veröffentlicht am ",new Date(s.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})," um ",new Date(s.created_at).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})]})]})]})]})]}),Ee&&e.jsxs("div",{className:"lightbox-overlay",onClick:()=>he(!1),children:[e.jsx("button",{className:o?g==="left"?"lightbox-close lightbox-close-mobile lightbox-close-left":"lightbox-close lightbox-close-mobile":"lightbox-close",onClick:()=>he(!1),"aria-label":"Schließen",children:"✕"}),w.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(m,{onClick:r=>{r.stopPropagation(),ye()},disabled:M===0,sx:{position:"absolute",left:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx(O,{size:32})}),e.jsx(m,{onClick:r=>{r.stopPropagation(),_e()},disabled:M===w.length-1,sx:{position:"absolute",right:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx(G,{size:32})}),e.jsxs(t,{sx:{position:"absolute",bottom:30,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.7)",color:"white",px:3,py:1,borderRadius:3,fontSize:"1rem",fontWeight:600,zIndex:1502},children:[M+1," / ",w.length]})]}),e.jsx("div",{className:"lightbox-content",onClick:r=>r.stopPropagation(),children:e.jsx("img",{src:Kt(w[M]),alt:s.title,loading:"lazy"})})]}),!o&&e.jsx(t,{sx:{position:"fixed",bottom:0,left:0,right:0,display:"flex",justifyContent:g==="left"?"flex-start":"flex-end",px:3,pb:1.5,gap:1,zIndex:500,pointerEvents:"none","& > *":{pointerEvents:"auto"}},children:g==="right"?e.jsxs(e.Fragment,{children:[xe&&e.jsx(m,{onClick:ve,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(We,{size:28})}),v.length>0&&B&&e.jsx(m,{onClick:()=>R("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(O,{size:28,color:"#1976d2"})}),v.length>0&&q&&e.jsx(m,{onClick:()=>R("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(G,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[v.length>0&&q&&e.jsx(m,{onClick:()=>R("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(G,{size:28,color:"#1976d2"})}),v.length>0&&B&&e.jsx(m,{onClick:()=>R("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(O,{size:28,color:"#1976d2"})}),xe&&e.jsx(m,{onClick:ve,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(We,{size:28})})]})}),o&&e.jsx(t,{sx:{position:"fixed",left:g==="left"?16:"auto",right:g==="left"?"auto":16,bottom:24,display:"flex",gap:1,zIndex:500},children:g==="right"?e.jsxs(e.Fragment,{children:[xe&&e.jsx(m,{onClick:ve,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(We,{size:28})}),v.length>0&&B&&e.jsx(m,{onClick:()=>R("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(O,{size:28,color:"#1976d2"})}),v.length>0&&q&&e.jsx(m,{onClick:()=>R("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(G,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[v.length>0&&q&&e.jsx(m,{onClick:()=>R("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(G,{size:28,color:"#1976d2"})}),v.length>0&&B&&e.jsx(m,{onClick:()=>R("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(O,{size:28,color:"#1976d2"})}),xe&&e.jsx(m,{onClick:ve,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(We,{size:28})})]})}),e.jsx(Bs,{open:ot,onClose:()=>ue(!1),title:"Artikel löschen",maxWidth:"xs",actions:e.jsxs(e.Fragment,{children:[e.jsx(W,{onClick:()=>ue(!1),variant:"outlined",sx:{textTransform:"none"},children:"Abbrechen"}),e.jsx(W,{onClick:async()=>{await k.from("items").delete().eq("id",s==null?void 0:s.id),ue(!1),d("/")},variant:"contained",color:"error",sx:{textTransform:"none"},children:"Löschen"})]}),children:e.jsx(a,{children:"Möchtest du diesen Artikel wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden."})}),l&&n&&s&&n.id===s.user_id&&e.jsx(jr,{onPublish:xs,onCancel:mt,isPublishing:fe,autoSaveStatus:gt,hasChanges:is,isDraft:s.status==="draft",itemStatus:s.status,isFirstItem:lt}),e.jsx(yr,{show:dt,targetElement:ns.current,onClose:()=>{as(!1),localStorage.setItem("hasSeenItemEditOnboarding","true")},title:"Inline-Bearbeitung",description:"Klicke einfach auf einen beliebigen Bereich wie den Titel, die Beschreibung oder die Bilder, um sie direkt zu bearbeiten. Deine Änderungen werden automatisch gespeichert."}),e.jsx(Bs,{open:ht,onClose:()=>me(!1),title:"Bilder verwalten",maxWidth:"xl",fullScreen:!0,actions:e.jsx(W,{onClick:()=>me(!1),variant:"contained",sx:{textTransform:"none"},children:"Fertig"}),children:e.jsx(t,{sx:{height:"100%",overflowY:"auto",p:2},children:e.jsx(Ps,{images:i.images||w.map(r=>({preview:r,existingUrl:r,isPrimary:r===w[0]})),onChange:r=>f("images",r),isEditing:l})})}),e.jsxs(Us,{open:pt,onClose:()=>be(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Os,{children:"Inserat ablehnen/sperren"}),e.jsxs(Ks,{children:[e.jsx(a,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Bitte gib einen Grund für die Ablehnung/Sperrung an. Der Verkäufer wird benachrichtigt."}),e.jsx(Ke,{label:"Ablehnungsgrund",multiline:!0,rows:4,fullWidth:!0,value:je,onChange:r=>os(r.target.value),placeholder:"z.B. Verstößt gegen Nutzungsbedingungen, Unerlaubter Inhalt, Falsche Kategorie..."})]}),e.jsxs(Gs,{children:[e.jsx(W,{onClick:()=>be(!1),children:"Abbrechen"}),e.jsx(W,{variant:"contained",color:"error",onClick:bt,disabled:ls||!je.trim(),children:"Sperren"})]})]}),e.jsx(Xs,{open:le.open,autoHideDuration:6e3,onClose:()=>ce({...le,open:!1}),children:e.jsx(te,{severity:le.severity,onClose:()=>ce({...le,open:!1}),children:le.message})})]}):null};export{Er as ItemDetailPage};
