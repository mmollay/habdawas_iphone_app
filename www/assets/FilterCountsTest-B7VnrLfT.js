import{r as o,G as w,j as t,B as d,T as e,ax as u,a0 as C,F as S}from"./index-DGPOwJJr.js";const E=(n,r=!0,l)=>{const[a,x]=o.useState(null),[i,c]=o.useState(!1),[h,f]=o.useState(!1),[m,g]=o.useState(null);return o.useEffect(()=>{if(!r)return;(async()=>{a===null?c(!0):f(!0),g(null);try{const{data:{session:s}}=await w.auth.getSession(),y=s==null?void 0:s.access_token,j=new URL("https://hsbjflixgavjqxvnkivi.supabase.co/functions/v1/get-filter-counts");n&&j.searchParams.set("category_id",n);const p=await fetch(j.toString(),{headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json"}});if(!p.ok){const v=await p.json();throw new Error(v.error||"Failed to fetch filter counts")}const b=await p.json();x(b)}catch(s){console.error("Error fetching filter counts:",s),g(s instanceof Error?s.message:"An error occurred")}finally{c(!1),f(!1)}})()},[n,r,JSON.stringify(l)]),{data:a,loading:i,isRefreshing:h,error:m}},A=()=>{const[n]=o.useState("f5fb69d5-e054-47e8-a72e-dc05fc3620bf"),{data:r,loading:l,error:a}=E(n);return t.jsxs(d,{sx:{p:3},children:[t.jsx(e,{variant:"h4",gutterBottom:!0,children:"ðŸ§ª Filter-API Test"}),t.jsxs(u,{sx:{p:2,mb:2},children:[t.jsxs(e,{variant:"body2",color:"text.secondary",children:["Kategorie: ",t.jsx("strong",{children:"Autos"})]}),t.jsxs(e,{variant:"caption",color:"text.secondary",sx:{display:"block",fontFamily:"monospace"},children:["ID: ",n]})]}),l&&t.jsx(d,{sx:{display:"flex",justifyContent:"center",p:4},children:t.jsx(C,{})}),a&&t.jsxs(S,{severity:"error",sx:{mb:2},children:[t.jsx("strong",{children:"Error:"})," ",a]}),r&&t.jsxs(t.Fragment,{children:[t.jsxs(u,{sx:{p:2,mb:2,bgcolor:"success.50"},children:[t.jsx(e,{variant:"h6",gutterBottom:!0,children:"âœ… API Response Erfolgreich!"}),t.jsxs(e,{variant:"body2",children:["ðŸ“Š Total Items: ",t.jsx("strong",{children:r.total_items})]}),r.price_range&&t.jsxs(e,{variant:"body2",children:["ðŸ’° Preis: ",t.jsxs("strong",{children:["â‚¬",r.price_range.min," - â‚¬",r.price_range.max]})]})]}),t.jsx(e,{variant:"h6",gutterBottom:!0,sx:{mt:3},children:"ðŸŽ¯ Filter mit Counts:"}),Object.entries(r.filters).map(([x,i])=>t.jsxs(u,{sx:{p:2,mb:2},children:[t.jsx(e,{variant:"subtitle1",sx:{fontWeight:600,mb:1},children:i.label}),t.jsxs(e,{variant:"caption",color:"text.secondary",sx:{display:"block",mb:1},children:["Key: ",x," | Type: ",i.type||"text"]}),t.jsx(d,{sx:{display:"flex",flexDirection:"column",gap:.5},children:i.values.map((c,h)=>t.jsxs(d,{sx:{display:"flex",justifyContent:"space-between",p:1,bgcolor:"grey.100",borderRadius:1},children:[t.jsx(e,{variant:"body2",children:c.value}),t.jsxs(e,{variant:"body2",sx:{fontWeight:600,color:"primary.main",minWidth:"40px",textAlign:"right"},children:["(",c.count,")"]})]},h))})]},x)),t.jsxs(u,{sx:{p:2,mt:3,bgcolor:"grey.50"},children:[t.jsx(e,{variant:"subtitle2",gutterBottom:!0,children:"ðŸ“„ Raw JSON:"}),t.jsx("pre",{style:{fontSize:"0.75rem",overflow:"auto",maxHeight:"300px",background:"white",padding:"12px",borderRadius:"4px"},children:JSON.stringify(r,null,2)})]})]})]})};export{A as FilterCountsTest};
