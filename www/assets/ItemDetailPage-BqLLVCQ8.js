import{g as ct,a as dt,r as h,u as ht,j as e,s as xt,c as pt,b as gt,m as ut,d as Rs,k as Fs,e as Es,f as $e,h as He,D as Ts,i as Ns,B as t,S as Ce,T as o,I as b,X as Ue,l as As,n as Be,o as ft,C as ys,L as bt,p as je,q as ye,t as _e,M as mt,v as ve,w as Q,x as jt,P as yt,y as z,Q as _t,z as vt,A as Ds,E as Ms,F as ee,G as k,H as Ls,J as Bs,K as wt,N as Ps,O as Pe,R as Vs,U as kt,V as St,W as Ct,Y as zt,Z as It,_ as Wt,$ as _s,a0 as Rt,a1 as X,a2 as vs,a3 as Fe,a4 as Ft,a5 as we,a6 as ws,a7 as Ee,a8 as Te,a9 as Et,aa as Tt,ab as Nt,ac as At,ad as Ne,ae as ks,af as Ss,ag as Ae,ah as Dt,ai as ke}from"./index-Cr_aSuNE.js";import{u as Cs}from"./index-DdEHrxem.js";import{I as zs,a as E,b as De,R as Mt,W as Lt,B as Bt,P as Pt,c as Se,H as Vt}from"./InlineImageGallery-CLCfNFu6.js";import{S as Me}from"./star-DmQVCCzy.js";import{C as U,a as $,M as Is}from"./Modal-XlAZZroc.js";import{C as qt}from"./calendar-CRxPvv7E.js";import{P as $t}from"./phone-BKlH-z8A.js";import{S as Ht}from"./send-BePmK5Ja.js";import"./plus-DRI1QaFw.js";function Ut(c){return String(c).match(/[\d.\-+]*\s*(.*)/)[1]||""}function Ot(c){return parseFloat(c)}function Kt(c){return ct("MuiSkeleton",c)}dt("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Gt=c=>{const{classes:d,variant:x,animation:a,hasChildren:g,width:f,height:m}=c;return gt({root:["root",x,a,g&&"withChildren",g&&!f&&"fitContent",g&&!m&&"heightAuto"]},Kt,d)},Ve=Fs`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,qe=Fs`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Xt=typeof Ve!="string"?Rs`
        animation: ${Ve} 2s ease-in-out 0.5s infinite;
      `:null,Yt=typeof qe!="string"?Rs`
        &::after {
          animation: ${qe} 2s linear 0.5s infinite;
        }
      `:null,Zt=xt("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(c,d)=>{const{ownerState:x}=c;return[d.root,d[x.variant],x.animation!==!1&&d[x.animation],x.hasChildren&&d.withChildren,x.hasChildren&&!x.width&&d.fitContent,x.hasChildren&&!x.height&&d.heightAuto]}})(ut(({theme:c})=>{const d=Ut(c.shape.borderRadius)||"px",x=Ot(c.shape.borderRadius);return{display:"block",backgroundColor:c.vars?c.vars.palette.Skeleton.bg:c.alpha(c.palette.text.primary,c.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${x}${d}/${Math.round(x/.6*10)/10}${d}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(c.vars||c).shape.borderRadius}},{props:({ownerState:a})=>a.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:a})=>a.hasChildren&&!a.width,style:{maxWidth:"fit-content"}},{props:({ownerState:a})=>a.hasChildren&&!a.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Xt||{animation:`${Ve} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(c.vars||c).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:Yt||{"&::after":{animation:`${qe} 2s linear 0.5s infinite`}}}]}})),Le=h.forwardRef(function(d,x){const a=ht({props:d,name:"MuiSkeleton"}),{animation:g="pulse",className:f,component:m="span",height:S,style:j,variant:l="text",width:s,...C}=a,T={...a,animation:g,component:m,variant:l,hasChildren:!!C.children},D=Gt(T);return e.jsx(Zt,{as:m,ref:x,className:pt(D.root,f),ownerState:T,...C,style:{width:s,height:S,...j}})});/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Es("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=Es("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Jt=({open:c,onClose:d,url:x,title:a,price:g,description:f})=>{const m=$e(),S=He(m.breakpoints.down("md")),[j,l]=h.useState(!1),[s,C]=h.useState(!1),[T,D]=h.useState(""),V=g!==void 0?`${a} - ${g.toFixed(2)} €`:a,O=async()=>{try{await navigator.clipboard.writeText(x),D("Link in Zwischenablage kopiert!"),C(!0)}catch{const W=document.createElement("textarea");W.value=x,W.style.position="fixed",W.style.left="-999999px",document.body.appendChild(W),W.select();try{document.execCommand("copy"),D("Link in Zwischenablage kopiert!"),C(!0)}catch{D("Kopieren fehlgeschlagen"),C(!0)}document.body.removeChild(W)}},y=async()=>{if(navigator.share)try{await navigator.share({title:a,text:V,url:x}),d()}catch(N){N.name!=="AbortError"&&console.error("Error sharing:",N)}else O()},M=()=>{window.open(`https://wa.me/?text=${encodeURIComponent(V+" "+x)}`,"_blank"),d()},H=()=>{window.open(`https://t.me/share/url?url=${encodeURIComponent(x)}&text=${encodeURIComponent(V)}`,"_blank"),d()},K=()=>{const N=a,W=g!==void 0?`${a}

Preis: ${g.toFixed(2)} €

${x}`:`${a}

${x}`;window.location.href=`mailto:?subject=${encodeURIComponent(N)}&body=${encodeURIComponent(W)}`,d()},Y=()=>{d(),setTimeout(()=>window.print(),100)};return e.jsxs(e.Fragment,{children:[e.jsxs(Ts,{open:c,onClose:d,maxWidth:"sm",fullWidth:!0,fullScreen:S,PaperProps:{sx:{borderRadius:S?0:3}},children:[e.jsxs(Ns,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:1},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(Ce,{size:24}),e.jsx(o,{variant:"h6",component:"span",children:"Teilen"})]}),e.jsx(b,{onClick:d,size:"small",children:e.jsx(Ue,{size:20})})]}),e.jsx(As,{children:e.jsxs(t,{sx:{display:"flex",flexDirection:"column",gap:3},children:[e.jsxs(t,{children:[e.jsx(o,{variant:"subtitle1",fontWeight:600,children:a}),g!==void 0&&e.jsxs(o,{variant:"body2",color:"text.secondary",children:[g.toFixed(2)," €"]})]}),e.jsx(t,{children:e.jsx(Be,{fullWidth:!0,value:x,InputProps:{readOnly:!0,endAdornment:e.jsx(ft,{title:"Kopieren",children:e.jsx(b,{onClick:O,edge:"end",size:"small",children:e.jsx(ys,{size:18})})}),sx:{fontFamily:"monospace",fontSize:"0.875rem"}},sx:{"& .MuiOutlinedInput-root":{backgroundColor:"action.hover"}}})}),e.jsxs(t,{children:[e.jsx(o,{variant:"subtitle2",fontWeight:600,sx:{mb:1},children:"Teilen über"}),e.jsxs(bt,{sx:{border:"1px solid",borderColor:"divider",borderRadius:2,p:0,overflow:"hidden"},children:[e.jsx(je,{disablePadding:!0,children:e.jsxs(ye,{onClick:M,children:[e.jsx(_e,{sx:{minWidth:40},children:e.jsx(mt,{size:20,color:"#25D366"})}),e.jsx(ve,{primary:"WhatsApp"})]})}),e.jsx(Q,{}),e.jsx(je,{disablePadding:!0,children:e.jsxs(ye,{onClick:H,children:[e.jsx(_e,{sx:{minWidth:40},children:e.jsx(t,{sx:{width:20,height:20},children:e.jsx("svg",{viewBox:"0 0 24 24",fill:"#0088cc",children:e.jsx("path",{d:"M12 0C5.373 0 0 5.373 0 12s5.373 12 12 12 12-5.373 12-12S18.627 0 12 0zm5.894 8.221l-1.97 9.28c-.145.658-.537.818-1.084.508l-3-2.21-1.446 1.394c-.14.18-.357.295-.6.295-.002 0-.003 0-.005 0l.213-3.054 5.56-5.022c.24-.213-.054-.334-.373-.121l-6.869 4.326-2.96-.924c-.64-.203-.658-.64.135-.954l11.566-4.458c.538-.196 1.006.128.832.941z"})})})}),e.jsx(ve,{primary:"Telegram"})]})}),e.jsx(Q,{}),e.jsx(je,{disablePadding:!0,children:e.jsxs(ye,{onClick:K,children:[e.jsx(_e,{sx:{minWidth:40},children:e.jsx(jt,{size:20})}),e.jsx(ve,{primary:"E-Mail"})]})}),e.jsx(Q,{}),e.jsx(je,{disablePadding:!0,children:e.jsxs(ye,{onClick:Y,children:[e.jsx(_e,{sx:{minWidth:40},children:e.jsx(yt,{size:20})}),e.jsx(ve,{primary:"Drucken"})]})})]})]}),e.jsxs(t,{children:[e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsx(o,{variant:"subtitle2",fontWeight:600,children:"QR-Code"}),e.jsx(z,{size:"small",startIcon:e.jsx(_t,{size:16}),onClick:()=>l(!j),sx:{textTransform:"none"},children:j?"Ausblenden":"Anzeigen"})]}),j&&e.jsx(t,{sx:{display:"flex",justifyContent:"center",p:3,bgcolor:"background.paper",borderRadius:2,border:"1px solid",borderColor:"divider"},children:e.jsx(vt,{value:x,size:S?200:256,level:"H",includeMargin:!0,style:{border:"8px solid white",borderRadius:"8px"}})})]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontStyle:"italic"},children:"💡 Teile diesen Link, um anderen dieses Inserat zu zeigen."})]})}),e.jsxs(Ds,{sx:{px:3,pb:3,gap:1,flexWrap:"wrap"},children:[e.jsx(z,{onClick:d,variant:"outlined",sx:{textTransform:"none"},children:"Schließen"}),e.jsx(z,{onClick:O,variant:"outlined",startIcon:e.jsx(ys,{size:18}),sx:{textTransform:"none"},children:"Link kopieren"}),navigator.share&&e.jsx(z,{onClick:y,variant:"contained",startIcon:e.jsx(Ce,{size:18}),sx:{textTransform:"none"},children:"Teilen"})]})]}),e.jsx(Ms,{open:s,autoHideDuration:3e3,onClose:()=>C(!1),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(ee,{onClose:()=>C(!1),severity:"success",variant:"filled",sx:{width:"100%"},children:T})})]})},er=()=>{const c=document.createElement("canvas"),d=c.getContext("2d");d&&(d.textBaseline="top",d.font="14px Arial",d.fillText("fingerprint",2,2));const x=[navigator.userAgent,navigator.language,screen.colorDepth,screen.width,screen.height,new Date().getTimezoneOffset(),c.toDataURL()].join("|");let a=0;for(let g=0;g<x.length;g++){const f=x.charCodeAt(g);a=(a<<5)-a+f,a=a&a}return Math.abs(a).toString(36)},sr=c=>{try{return JSON.parse(sessionStorage.getItem("viewedItems")||"[]").includes(c)}catch{return!1}},tr=c=>{try{const d=JSON.parse(sessionStorage.getItem("viewedItems")||"[]");d.includes(c)||(d.push(c),sessionStorage.setItem("viewedItems",JSON.stringify(d)))}catch(d){console.error("Failed to mark item as viewed:",d)}},rr=(c,d=!1)=>{h.useEffect(()=>{if(!c||!d||sr(c))return;const a=setTimeout(async()=>{try{const{data:{user:g}}=await k.auth.getUser(),{error:f}=await k.from("item_views").insert({item_id:c,viewer_id:(g==null?void 0:g.id)||null,session_fingerprint:g?null:er()});f&&!f.message.includes("unique")?console.error("Failed to track view:",f):tr(c)}catch(g){console.error("Failed to track view:",g)}},2e3);return()=>clearTimeout(a)},[c,d])},ir=({itemId:c,draftData:d,enabled:x,debounceMs:a=1e3})=>{const[g,f]=h.useState("idle"),m=h.useRef(null),S=h.useRef("");return h.useEffect(()=>{if(!x)return;const j=JSON.stringify(d);if(j!==S.current)return S.current=j,m.current&&clearTimeout(m.current),f("saving"),m.current=setTimeout(async()=>{try{const{error:l}=await k.from("items").update({draft_data:d,has_draft:!0,draft_updated_at:new Date().toISOString()}).eq("id",c);if(l)throw l;f("saved"),setTimeout(()=>{f("idle")},2e3)}catch(l){console.error("Auto-save error:",l),f("error")}},a),()=>{m.current&&clearTimeout(m.current)}},[c,d,x,a]),{status:g}},nr=()=>{const{user:c}=Ls(),[d,x]=h.useState([]),[a,g]=h.useState(!0);return h.useEffect(()=>{(async()=>{if(!c){x([]),g(!1);return}try{const{data:l,error:s}=await k.rpc("get_user_permissions",{check_user_id:c.id});if(s)throw s;const C=(l==null?void 0:l.map(T=>T.permission_name))||[];x(C)}catch(l){console.error("Error loading permissions:",l),x([])}finally{g(!1)}})()},[c]),{permissions:d,loading:a,hasPermission:j=>d.includes(j),hasAnyPermission:j=>j.some(l=>d.includes(l)),hasAllPermissions:j=>j.every(l=>d.includes(l))}},ar=({onPublish:c,onCancel:d,isPublishing:x,autoSaveStatus:a,hasChanges:g,isDraft:f,itemStatus:m})=>{const S=$e(),j=He(S.breakpoints.down("md")),[l,s]=h.useState(!1);h.useEffect(()=>{if(a==="saving")s(!0);else if(a==="saved"){const D=setTimeout(()=>{s(!1)},1500);return()=>clearTimeout(D)}else(a==="idle"||a==="error")&&s(!1)},[a]);const C=()=>x||!l?null:a==="saving"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"primary.main",animation:"pulse 1.5s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.6},"50%":{opacity:1}}},children:e.jsx(Me,{size:16})}):a==="saved"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"success.main",animation:"fadeIn 0.3s ease-in","@keyframes fadeIn":{"0%":{opacity:0,transform:"scale(0.8)"},"100%":{opacity:1,transform:"scale(1)"}}},children:e.jsx(Me,{size:16})}):a==="error"?e.jsx(t,{sx:{display:"flex",alignItems:"center",color:"error.main"},children:e.jsx(Me,{size:16})}):null,T=()=>x?f?"Wird veröffentlicht...":"Wird gespeichert...":m==="draft"?"Veröffentlichen":m==="published"?"Änderungen speichern":m==="paused"?"Speichern":"Änderungen übernehmen";return e.jsx(e.Fragment,{children:e.jsxs(Bs,{elevation:8,sx:{position:"fixed",bottom:j?16:32,left:"50%",transform:"translateX(-50%)",zIndex:1300,bgcolor:"background.paper",borderRadius:4,border:f?"2px solid":"1px solid",borderColor:f?"warning.main":"divider",boxShadow:f?"0 12px 48px rgba(237, 108, 2, 0.15)":"0 8px 32px rgba(0,0,0,0.08)",minWidth:j?"calc(100% - 32px)":"auto",maxWidth:j?"calc(100% - 32px)":600,overflow:"hidden"},children:[f&&e.jsxs(t,{sx:{bgcolor:"rgba(237, 108, 2, 0.04)",px:2.5,py:.75,borderBottom:"1px solid rgba(237, 108, 2, 0.1)",display:"flex",alignItems:"center",justifyContent:"space-between",gap:1.5},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(wt,{size:14,color:"#ed6c02",style:{flexShrink:0}}),e.jsx(o,{variant:"body2",sx:{color:"#e65100",fontSize:"0.8125rem",fontWeight:500},children:"Änderungen werden automatisch gespeichert"})]}),e.jsx(t,{sx:{display:"flex",alignItems:"center",minWidth:20},children:C()})]}),e.jsxs(t,{sx:{p:1.5,display:"flex",alignItems:"center",justifyContent:"flex-end",gap:1.5,flexDirection:"row",position:"relative"},children:[e.jsx(z,{variant:"outlined",onClick:d,disabled:x,startIcon:e.jsx(Ue,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:2.5,fontWeight:500},children:"Abbrechen"}),e.jsx(z,{variant:"contained",onClick:c,disabled:x||!g,startIcon:e.jsx(Ps,{size:18}),sx:{height:40,borderRadius:2,textTransform:"none",px:3,fontWeight:600,bgcolor:f?"warning.main":"primary.main","&:hover":{bgcolor:f?"warning.dark":"primary.dark"}},children:T()})]})]})})},or=({show:c,targetElement:d,onClose:x,title:a,description:g,step:f=1,totalSteps:m=1})=>{const[S,j]=h.useState({top:0,left:0});return h.useEffect(()=>{if(!c||!d)return;const l=()=>{const s=d.getBoundingClientRect(),C=window.scrollY,T=window.scrollX;j({top:s.top+C-180,left:s.left+T+s.width/2})};return l(),window.addEventListener("resize",l),window.addEventListener("scroll",l),()=>{window.removeEventListener("resize",l),window.removeEventListener("scroll",l)}},[c,d]),!c||!d?null:e.jsxs(e.Fragment,{children:[e.jsx(t,{sx:{position:"fixed",top:0,left:0,right:0,bottom:0,bgcolor:"rgba(0, 0, 0, 0.4)",zIndex:1400,animation:"fadeIn 0.3s ease-in-out","@keyframes fadeIn":{from:{opacity:0},to:{opacity:1}}},onClick:x}),e.jsxs(t,{sx:{position:"absolute",top:S.top,left:S.left,transform:"translateX(-50%)",zIndex:1401,animation:"slideDown 0.4s cubic-bezier(0.16, 1, 0.3, 1)","@keyframes slideDown":{from:{opacity:0,transform:"translateX(-50%) translateY(-20px)"},to:{opacity:1,transform:"translateX(-50%) translateY(0)"}}},children:[e.jsxs(Bs,{elevation:24,sx:{position:"relative",bgcolor:"white",borderRadius:3,p:3,maxWidth:360,boxShadow:"0 24px 64px rgba(0, 0, 0, 0.24)",border:"1px solid rgba(0, 0, 0, 0.06)","&::after":{content:'""',position:"absolute",bottom:-12,left:"50%",transform:"translateX(-50%)",width:0,height:0,borderLeft:"12px solid transparent",borderRight:"12px solid transparent",borderTop:"12px solid white",filter:"drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1))"}},children:[e.jsx(b,{onClick:x,sx:{position:"absolute",top:8,right:8,width:32,height:32,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:e.jsx(Ue,{size:18})}),e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:1.5,mb:2},children:[e.jsx(t,{sx:{width:40,height:40,borderRadius:"50%",bgcolor:"primary.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,background:"linear-gradient(135deg, #1976d2 0%, #1565c0 100%)",boxShadow:"0 4px 12px rgba(25, 118, 210, 0.3)"},children:e.jsx(Pe,{size:20,color:"white"})}),e.jsxs(t,{sx:{flex:1,pt:.5},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,mb:.5,color:"text.primary"},children:a}),m>1&&e.jsxs(o,{variant:"caption",sx:{color:"text.secondary",fontWeight:500},children:["Schritt ",f," von ",m]})]})]}),e.jsx(o,{variant:"body2",sx:{color:"text.secondary",lineHeight:1.6,mb:3},children:g}),e.jsx(t,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:e.jsx(z,{onClick:x,variant:"contained",sx:{borderRadius:2,textTransform:"none",fontWeight:600,px:3,boxShadow:"none","&:hover":{boxShadow:"0 2px 8px rgba(25, 118, 210, 0.24)"}},children:"Verstanden"})})]}),e.jsx(t,{sx:{position:"absolute",top:"100%",left:"50%",transform:"translateX(-50%)",mt:2,width:2,height:40,bgcolor:"primary.main",borderRadius:1,opacity:.4,animation:"pulse 2s ease-in-out infinite","@keyframes pulse":{"0%, 100%":{opacity:.4},"50%":{opacity:.8}}}})]})]})},lr=({userId:c,currentItemId:d})=>{const[x,a]=h.useState(null),[g,f]=h.useState([]),[m,S]=h.useState(0),[j,l]=h.useState(!0),s=Vs();h.useEffect(()=>{C()},[c]);const C=async()=>{try{const{data:y,error:M}=await k.from("profiles").select("id, full_name, avatar_url, created_at, show_seller_profile").eq("id",c).single();if(M)throw M;if(a(y),!y.show_seller_profile){l(!1);return}let H=k.from("items").select("id, title, price, image_url, status",{count:"exact"}).eq("user_id",c).eq("status","published");d&&(H=H.neq("id",d));const{data:K,error:Y,count:N}=await H.order("created_at",{ascending:!1}).limit(4);if(Y)throw Y;f(K||[]),S(N||0)}catch(y){console.error("Error fetching seller data:",y)}finally{l(!1)}},T=y=>{const M=new Date(y),H=M.toLocaleDateString("de-DE",{month:"long"}),K=M.getFullYear();return`${H} ${K}`},D=y=>y?y.split(" ").map(M=>M[0]).join("").toUpperCase().slice(0,2):"U",V=()=>{s(`/?seller=${c}`)},O=y=>{s(`/item/${y}`)};return j?e.jsx(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,mb:2},children:[e.jsx(Le,{variant:"circular",width:60,height:60}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(Le,{variant:"text",width:"60%",height:24}),e.jsx(Le,{variant:"text",width:"40%",height:20})]})]})}):!x||!x.show_seller_profile?e.jsx(t,{sx:{p:2,bgcolor:"#f5f5f5",borderRadius:2,border:"1px solid #e0e0e0"},children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(kt,{size:16,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",fontWeight:500,children:"Privater Verkäufer"})]})}):e.jsxs(t,{sx:{p:3,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"flex-start",gap:2,mb:3},children:[e.jsx(St,{src:x.avatar_url||void 0,sx:{width:60,height:60,bgcolor:"#1976d2",fontSize:"1.25rem",fontWeight:600},children:D(x.full_name)}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"h6",fontWeight:600,sx:{mb:.5},children:x.full_name||"Benutzer"}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Mitglied seit ",T(x.created_at)]}),m>0&&e.jsxs(o,{variant:"body2",color:"primary",fontWeight:500,sx:{mt:.5},children:[m," ",m===1?"aktives Inserat":"aktive Inserate"]})]})]}),g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"subtitle2",fontWeight:600,sx:{mb:1.5},children:"Weitere Inserate"}),e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,mb:2,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3}},children:g.map(y=>e.jsxs(t,{onClick:()=>O(y.id),sx:{width:110,minWidth:110,maxWidth:110,flexShrink:0,cursor:"pointer",transition:"transform 0.2s","&:hover":{transform:"scale(1.05)"}},children:[e.jsx(t,{sx:{width:"100%",height:110,bgcolor:"#e0e0e0",borderRadius:1.5,overflow:"hidden",mb:.5},children:y.image_url?e.jsx("img",{src:y.image_url,alt:y.title,style:{width:"100%",height:"100%",objectFit:"cover"}}):e.jsx(t,{sx:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"#f5f5f5"},children:e.jsx(o,{variant:"caption",color:"text.secondary",children:"Kein Bild"})})}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.8rem",lineHeight:1.3,overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",mb:.25,minHeight:"2.1em"},children:y.title}),e.jsxs(o,{variant:"body2",fontWeight:600,color:"primary",sx:{fontSize:"0.85rem"},children:[y.price.toFixed(2)," €"]})]},y.id))}),e.jsx(z,{variant:"outlined",onClick:V,endIcon:e.jsx(U,{size:18}),fullWidth:!0,sx:{textTransform:"none",borderRadius:1.5,py:1},children:"Alle Inserate anzeigen"})]})]})},mr=()=>{var ns,as,os,ls,cs,ds,hs,xs,ps,gs,us,fs,bs,ms;const{id:c}=Ct(),d=Vs(),x=zt(),{user:a}=Ls(),{handPreference:g}=It(),{isFavorite:f,toggleFavorite:m,loading:S}=Wt(),j=$e(),l=He(j.breakpoints.down("md")),[s,C]=h.useState(null),[T,D]=h.useState(!0),[V,O]=h.useState(""),[y,M]=h.useState(!1),[H,K]=h.useState(!1),[Y,N]=h.useState(null),[W,ze]=h.useState(null),[F,oe]=h.useState(null),[Ie,le]=h.useState(!1),[A,se]=h.useState(0),We=h.useRef(!1),[te,qs]=h.useState(1),[$s,Hs]=h.useState(0),Us=h.useRef(null),[ce,Os]=h.useState(!1),[Ks,Oe]=h.useState(!1),[Ke,de]=h.useState([]),[n,J]=h.useState(!1),[i,re]=h.useState({}),[he,Ge]=h.useState(!1),[Xe,ie]=h.useState(!1),[Gs,xe]=h.useState(!1),[Xs,Ys]=h.useState(!1),[Zs,Ye]=h.useState(!1),Ze=h.useRef(null),[Qs,pe]=h.useState(!1),{hasPermission:Js}=nr(),[et,ge]=h.useState(!1),[ue,Qe]=h.useState(""),[Je,es]=h.useState(!1),[ne,ae]=h.useState({open:!1,message:"",severity:"success"}),{status:st}=ir({itemId:c||"",draftData:i,enabled:n&&Xe,debounceMs:1500}),_=((ns=x.state)==null?void 0:ns.allItems)||[],Z=_.findIndex(r=>r.id===c),L=Z>0,B=Z>=0&&Z<_.length-1,ss=()=>{const r=sessionStorage.getItem("returnSearch");r?(d(`/${r}`),sessionStorage.removeItem("returnSearch")):d("/")},I=h.useCallback(async r=>{const p=r==="prev"&&L?_[Z-1]:r==="next"&&B?_[Z+1]:null;if(!p)return;C(p),se(0),window.scrollTo(0,0);const{data:R}=await k.from("item_images").select("image_url, display_order, is_primary").eq("item_id",p.id).order("display_order",{ascending:!0});R&&R.length>0?de(R.map(q=>q.image_url)):de(p.image_url?[p.image_url]:[]);const{data:P}=await k.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",p.user_id).maybeSingle();if(ze(P),p.selected_address_id){const{data:q}=await k.from("addresses").select("*").eq("id",p.selected_address_id).maybeSingle();oe(q)}else oe(null);We.current=!0,d(`/item/${p.id}`,{state:{allItems:_},replace:!0})},[_,Z,L,B,d]),v=Ke.length>0?Ke:s!=null&&s.image_url?[s.image_url]:[],fe=()=>{se(r=>r===0?v.length-1:r-1)},be=()=>{se(r=>r===v.length-1?0:r+1)},tt=Cs({onSwipedLeft:be,onSwipedRight:fe,trackMouse:!1,trackTouch:!0}),rt=Cs({onSwipedLeft:()=>B&&I("next"),onSwipedRight:()=>L&&I("prev"),trackMouse:!1,trackTouch:!0});rr(s==null?void 0:s.id,!!s),h.useEffect(()=>{const r=()=>{Os(window.scrollY>500)};return window.addEventListener("scroll",r),()=>window.removeEventListener("scroll",r)},[]);const me=()=>{window.scrollTo({top:0,behavior:"smooth"})},Re=async()=>{if(c){if(We.current){We.current=!1;return}D(!0);try{const{data:r,error:p}=await k.from("items").select("*").eq("id",c).maybeSingle();if(p)throw p;if(!r){d("/");return}if(r.status==="draft"&&(!a||a.id!==r.user_id)){d("/");return}if(C(r),a&&a.id===r.user_id)if(r.status==="draft"){r.draft_data&&re(r.draft_data),J(!0),ie(!0);const{count:G}=await k.from("items").select("*",{count:"exact",head:!0}).eq("user_id",a.id).neq("status","draft"),js=G===0;Ys(js);const lt=localStorage.getItem("hasSeenItemEditOnboarding");js&&!lt&&setTimeout(()=>{Ye(!0)},800)}else r.has_draft&&r.draft_data&&(re(r.draft_data),ie(!0),J(!0));const{data:R}=await k.from("item_images").select("image_url, display_order, is_primary").eq("item_id",c).order("display_order",{ascending:!0});R&&R.length>0?de(R.map(G=>G.image_url)):de(r.image_url?[r.image_url]:[]);const{data:P,error:q}=await k.from("profiles").select("show_location_to_public, full_name, phone_verified").eq("id",r.user_id).maybeSingle();if(q)throw q;if(ze(P),r.selected_address_id){const{data:G}=await k.from("addresses").select("*").eq("id",r.selected_address_id).maybeSingle();oe(G)}else oe(null)}catch(r){console.error("Error loading item:",r),d("/")}finally{D(!1)}}};h.useEffect(()=>{Re()},[c,d]),h.useEffect(()=>(s!=null&&s.title&&(document.title=s.title),()=>{document.title="Bazar - Dein Online-Flohmarkt"}),[s==null?void 0:s.title]);const u=(r,p)=>{re(R=>({...R,[r]:p})),ie(!0)},ts=async()=>{if(!(!s||!c)){Ge(!0);try{const{images:r,...p}=i,R={...p,status:s.status==="draft"?"published":s.status,has_draft:!1,draft_data:null,draft_updated_at:null,updated_at:new Date().toISOString()},{error:P}=await k.from("items").update(R).eq("id",c);if(P)throw P;C({...s,...p}),J(!1),ie(!1),re({}),await Re()}catch(r){console.error("Error publishing:",r),N("Fehler beim Veröffentlichen der Änderungen")}finally{Ge(!1)}}},it=async()=>{if(c)try{await k.from("items").update({has_draft:!1,draft_data:null,draft_updated_at:null}).eq("id",c),J(!1),ie(!1),re({})}catch(r){console.error("Error canceling edit:",r)}},nt=async()=>{if(!ue.trim()){ae({open:!0,message:"Bitte gib einen Grund für die Ablehnung an",severity:"error"});return}es(!0);try{const{error:r}=await k.rpc("reject_item",{item_id:c,reason:ue});if(r)throw r;ae({open:!0,message:"Inserat wurde abgelehnt",severity:"success"}),ge(!1),Qe(""),await Re()}catch(r){ae({open:!0,message:`Fehler: ${r.message}`,severity:"error"})}finally{es(!1)}};h.useEffect(()=>{window.scrollTo(0,0),se(0)},[s==null?void 0:s.id]),h.useEffect(()=>{if(!l)return;const r=()=>{const p=window.scrollY,P=Math.max(0,1-p/600),q=-(p*.05);qs(P),Hs(q)};return window.addEventListener("scroll",r,{passive:!0}),()=>window.removeEventListener("scroll",r)},[l]),h.useEffect(()=>{const r=p=>{if(!(p.target instanceof HTMLInputElement||p.target instanceof HTMLTextAreaElement)&&!Ie)switch(p.key){case"ArrowLeft":L&&(p.preventDefault(),I("prev"));break;case"ArrowRight":B&&(p.preventDefault(),I("next"));break;case"ArrowUp":L&&(p.preventDefault(),I("prev"));break;case"ArrowDown":B&&(p.preventDefault(),I("next"));break}};return window.addEventListener("keydown",r),()=>window.removeEventListener("keydown",r)},[L,B,Ie,I]);const rs=async()=>{s&&await m(s.id)},w=()=>{},is=()=>{Oe(!0)},at=()=>{Oe(!1)},ot=async()=>{if(!a){alert("Bitte melde dich an, um eine Nachricht zu senden.");return}if(!V.trim()||!s){N("Bitte gib eine Nachricht ein.");return}if(a.id===s.user_id){N("Du kannst dir selbst keine Nachricht senden.");return}M(!0),N(null);try{const{data:r,error:p}=await k.from("conversations").select("id").eq("item_id",s.id).eq("buyer_id",a.id).eq("seller_id",s.user_id).maybeSingle();if(p&&p.code!=="PGRST116")throw p;let R;if(r)R=r.id;else{const{data:q,error:G}=await k.from("conversations").insert({item_id:s.id,buyer_id:a.id,seller_id:s.user_id}).select("id").single();if(G)throw G;R=q.id}const{error:P}=await k.from("messages").insert({conversation_id:R,sender_id:a.id,content:V.trim()});if(P)throw P;O(""),K(!0),setTimeout(()=>K(!1),3e3)}catch(r){console.error("Error sending message:",r),N("Fehler beim Senden der Nachricht. Bitte versuche es erneut.")}finally{M(!1)}};return T?e.jsx(t,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh"},children:e.jsx(_s,{})}):s?e.jsxs(t,{sx:{minHeight:"100vh",bgcolor:"#fafafa"},children:[e.jsxs(t,{className:"print-only",sx:{display:"none"},children:[e.jsx(t,{className:"print-header",children:e.jsxs(t,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsx(t,{children:e.jsx("img",{src:"/logo.png",alt:"HABDAWAS Logo",className:"print-logo"})}),e.jsx(t,{sx:{textAlign:"right",fontSize:"8pt",color:"#666"},children:e.jsxs(o,{variant:"caption",sx:{display:"block",fontSize:"8pt"},children:["Gedruckt: ",new Date().toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})})]})}),e.jsx(t,{className:"print-main-section",children:e.jsxs(t,{sx:{display:"flex",gap:2,mb:2},children:[e.jsx(t,{className:"print-image-container",children:v.slice(0,1).map((r,p)=>e.jsx("img",{src:r,alt:s.title,className:"print-main-image"},p))}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{className:"print-title",children:s.title}),e.jsxs(t,{className:"print-price-box",children:[s.price.toFixed(2)," €"]})]})]})}),e.jsxs(t,{className:"print-details-grid",children:[(s.postal_code||s.location)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📍 Standort:"}),e.jsx(t,{className:"print-detail-value",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),s.condition&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✨ Zustand:"}),e.jsx(t,{className:"print-detail-value",children:Rt(s.condition)})]}),s.brand&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🏷️ Marke:"}),e.jsx(t,{className:"print-detail-value",children:s.brand})]}),s.category&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📦 Kategorie:"}),e.jsx(t,{className:"print-detail-value",children:s.category})]}),s.subcategory&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📑 Unterkategorie:"}),e.jsx(t,{className:"print-detail-value",children:s.subcategory})]}),s.shipping_cost!==null&&s.shipping_cost!==void 0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🚚 Versandkosten:"}),e.jsx(t,{className:"print-detail-value",children:s.shipping_cost===0?"Kostenloser Versand":`${s.shipping_cost.toFixed(2)} €`})]}),s.size&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📏 Größe:"}),e.jsx(t,{className:"print-detail-value",children:s.size})]}),(s.dimensions_length||s.dimensions_width||s.dimensions_height)&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"📐 Abmessungen:"}),e.jsx(t,{className:"print-detail-value",children:s.dimensions_length&&s.dimensions_width&&s.dimensions_height?`${s.dimensions_length} × ${s.dimensions_width} × ${s.dimensions_height} cm`:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")+" cm"})]}),s.weight&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"⚖️ Gewicht:"}),e.jsx(t,{className:"print-detail-value",children:s.weight})]}),s.quantity&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Verfügbare Menge:"}),e.jsx(t,{className:"print-detail-value",children:s.quantity})]}),s.colors&&s.colors.length>0&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🎨 Farben:"}),e.jsx(t,{className:"print-detail-value",children:s.colors.join(", ")})]}),s.material&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🧵 Material:"}),e.jsx(t,{className:"print-detail-value",children:s.material})]}),s.style&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"✂️ Stil:"}),e.jsx(t,{className:"print-detail-value",children:s.style})]}),s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔖 Seriennummer:"}),e.jsx(t,{className:"print-detail-value",children:s.serial_number})]}),s.item_number&&e.jsxs(t,{className:"print-detail-row",children:[e.jsx(t,{className:"print-detail-label",children:"🔢 Artikelnummer:"}),e.jsx(t,{className:"print-detail-value",children:s.item_number})]})]}),s.description&&e.jsxs(t,{className:"print-description-box",children:[e.jsx("span",{className:"print-section-title",children:"📝 Beschreibung:"}),e.jsx(o,{className:"print-description-text",children:s.description})]}),(((as=s.features)==null?void 0:as.length)>0||((os=s.accessories)==null?void 0:os.length)>0)&&e.jsxs(t,{className:"print-extra-box",children:[((ls=s.features)==null?void 0:ls.length)>0&&e.jsxs(t,{sx:{mb:1},children:[e.jsx("span",{className:"print-section-title",children:"⭐ Merkmale:"})," ",s.features.join(" • ")]}),((cs=s.accessories)==null?void 0:cs.length)>0&&e.jsxs(t,{children:[e.jsx("span",{className:"print-section-title",children:"🎁 Zubehör:"})," ",s.accessories.join(" • ")]})]}),W&&e.jsxs(t,{className:"print-contact-section",children:[e.jsx(t,{className:"print-section-title",children:"📞 Kontakt zum Anbieter:"}),e.jsxs(t,{sx:{fontSize:"8.5pt",lineHeight:1.5},children:[W.full_name&&e.jsxs(t,{children:[e.jsx("strong",{children:"Name:"})," ",W.full_name,W.phone_verified&&e.jsx(X,{icon:e.jsx(Ws,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{ml:1,height:20}})]}),(F==null?void 0:F.phone)&&(F==null?void 0:F.show_phone_publicly)&&e.jsxs(t,{children:[e.jsx("strong",{children:"Telefon:"})," ",F.phone]}),e.jsxs(t,{children:[e.jsx("strong",{children:"Nachricht:"})," Über HABDAWAS.at Nachrichten-System"]})]})]}),e.jsx(t,{className:"print-footer",children:e.jsxs(o,{variant:"caption",sx:{fontSize:"7pt"},children:["HABDAWAS.at • Hollenthon 33, 2812 Hollenthon • +43 650 25 26 266 • ID: ",s.id.slice(0,10)]})})]}),s&&e.jsx(Jt,{open:Ks,onClose:at,url:window.location.href,title:s.title,price:s.price}),!l&&_.length>0&&e.jsx(t,{sx:{position:"fixed",top:72,left:0,right:0,zIndex:100,bgcolor:"white",borderBottom:"1px solid",borderColor:"divider",py:1.5},children:e.jsx(vs,{maxWidth:"lg",children:e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:2,height:48},children:[e.jsx(z,{variant:"text",startIcon:e.jsx($,{size:18}),onClick:ss,sx:{textTransform:"none",fontSize:"14px",fontWeight:500,px:2,height:40,color:"text.secondary","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)"}},children:"Zurück"}),(a==null?void 0:a.id)===s.user_id&&e.jsx(e.Fragment,{children:e.jsx(z,{variant:n?"contained":"outlined",startIcon:e.jsx(Fe,{size:18}),onClick:()=>J(!n),sx:{textTransform:"none",fontSize:"14px",fontWeight:600,px:2.5,height:40,borderRadius:2,boxShadow:n?1:0},children:"Bearbeiten"})}),Js("items.reject")&&s.status==="published"&&e.jsx(z,{variant:"outlined",color:"error",startIcon:e.jsx(Qt,{size:18}),onClick:()=>ge(!0),disabled:Je,sx:{textTransform:"none",fontSize:"14px",fontWeight:600,px:2.5,height:40,borderRadius:2},children:"Sperren"}),(a==null?void 0:a.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,px:2,py:.75,borderRadius:2,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:8,height:8,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(o,{sx:{fontSize:"13px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(b,{onClick:()=>xe(!0),sx:{color:"text.secondary",height:40,width:40,"&:hover":{bgcolor:"rgba(211, 47, 47, 0.08)",color:"error.main"}},children:e.jsx(Ft,{size:18})})]}),e.jsx(t,{sx:{flex:1}}),e.jsx(b,{onClick:rs,disabled:!a||S,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:s&&f(s.id)?e.jsx(we,{size:20,fill:"currentColor"}):e.jsx(we,{size:20})}),e.jsx(b,{onClick:is,size:"small",sx:{color:"text.secondary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:e.jsx(Ce,{size:20})}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,height:40,px:1.5,borderRadius:2,bgcolor:"rgba(0, 0, 0, 0.04)"},children:[e.jsx(b,{onClick:()=>I("prev"),disabled:!L,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx($,{size:20})}),e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{minWidth:50,textAlign:"center",fontSize:"14px",fontWeight:500},children:[Z+1," / ",_.length]}),e.jsx(b,{onClick:()=>I("next"),disabled:!B,size:"small",sx:{color:"text.secondary","&.Mui-disabled":{color:"action.disabled"}},children:e.jsx(U,{size:20})})]})]})})}),e.jsxs(vs,{maxWidth:"lg",sx:{py:l?2:3,px:l?0:3,pt:!l&&_.length>0?14:l?2:3},children:[a&&s&&a.id===s.user_id&&s.status==="published"&&s.has_draft&&e.jsxs(t,{sx:{mb:3,p:3,borderRadius:3,border:"2px solid",borderColor:"warning.main",bgcolor:"rgba(237, 108, 2, 0.04)",display:"flex",alignItems:"center",gap:3,flexDirection:l?"column":"row"},children:[e.jsx(t,{sx:{width:48,height:48,borderRadius:3,bgcolor:"warning.main",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0},children:e.jsx(Fe,{size:24,color:"white"})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:700,mb:.5,fontSize:"1.1rem"},children:"Unveröffentlichte Änderungen"}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{lineHeight:1.6},children:"Du hast Änderungen vorgenommen, die noch nicht veröffentlicht wurden. Übernimm die Änderungen, damit sie für andere sichtbar werden."})]}),e.jsx(z,{size:"large",variant:"contained",color:"warning",onClick:ts,disabled:he,startIcon:he?e.jsx(_s,{size:18,color:"inherit"}):e.jsx(Ps,{size:20}),sx:{minWidth:180,height:48,borderRadius:3,textTransform:"none",fontSize:"1rem",fontWeight:600,boxShadow:2,"&:hover":{boxShadow:4},flexShrink:0},children:he?"Wird aktualisiert...":"Änderungen übernehmen"})]}),e.jsxs(t,{sx:{display:"flex",flexDirection:l?"column":"row",gap:l?0:2},children:[!l&&e.jsx(t,{sx:{flex:"1 1 40%",position:"sticky",top:_.length>0?160:80,alignSelf:"flex-start",maxHeight:_.length>0?"calc(100vh - 260px)":"calc(100vh - 180px)",display:"flex",flexDirection:"column",gap:2},children:(a==null?void 0:a.id)===s.user_id&&n?e.jsxs(t,{sx:{position:"relative"},children:[e.jsx(zs,{images:i.images||v.map(r=>({preview:r,existingUrl:r,isPrimary:r===v[0]})),onChange:r=>u("images",r),isEditing:n}),e.jsx(b,{onClick:()=>pe(!0),sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:10},children:e.jsx(ws,{size:20})})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{position:"relative",width:"100%",height:v.length>1?"calc(100% - 120px)":"100%",bgcolor:"#f5f5f5",borderRadius:2,overflow:"hidden",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",boxShadow:3},onClick:()=>le(!0),children:[e.jsx(t,{component:"img",src:Ee(v[A]),alt:s.title,loading:"lazy",sx:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain",transition:"opacity 0.3s ease-in-out"}}),v.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:r=>{r.stopPropagation(),fe()},disabled:A===0,sx:{position:"absolute",left:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx($,{})}),e.jsx(b,{onClick:r=>{r.stopPropagation(),be()},disabled:A===v.length-1,sx:{position:"absolute",right:12,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.95)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2},children:e.jsx(U,{})}),e.jsxs(t,{sx:{position:"absolute",top:12,right:12,bgcolor:"rgba(0,0,0,0.65)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20},children:[A+1," / ",v.length]})]})]}),v.length>1&&e.jsx(t,{sx:{display:"flex",gap:1.5,overflowX:"auto",pb:1,"&::-webkit-scrollbar":{height:6},"&::-webkit-scrollbar-track":{bgcolor:"#f5f5f5",borderRadius:3},"&::-webkit-scrollbar-thumb":{bgcolor:"#ccc",borderRadius:3,"&:hover":{bgcolor:"#999"}}},children:v.map((r,p)=>e.jsxs(t,{onClick:()=>se(p),sx:{minWidth:100,width:100,height:100,borderRadius:1.5,overflow:"hidden",cursor:"pointer",border:A===p?"3px solid #1976d2":"3px solid transparent",opacity:A===p?1:.6,transition:"all 0.2s ease",position:"relative","&:hover":{opacity:1,transform:"scale(1.05)"}},children:[e.jsx(t,{component:"img",src:Ee(r),alt:`${s.title} - Vorschau ${p+1}`,loading:"lazy",sx:{width:"100%",height:"100%",objectFit:"cover"}}),p===0&&e.jsx(t,{sx:{position:"absolute",top:4,left:4,bgcolor:"primary.main",color:"white",px:.75,py:.25,borderRadius:1,fontSize:"0.65rem",fontWeight:700,textTransform:"uppercase"},children:"Haupt"})]},p))})]})}),e.jsxs(t,{...l&&_.length>0?rt:{},sx:{flex:l?"1":"1 1 60%",bgcolor:"white",borderRadius:2,overflow:"visible",maxHeight:"none",mt:l?"-55px":0},children:[l&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{...tt,sx:{position:"fixed",top:55,left:0,right:0,width:"100%",height:"400px",bgcolor:"#f5f5f5",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",overflow:"hidden",zIndex:1},onClick:()=>le(!0),children:[e.jsx(t,{component:"img",src:Ee(v[A]),alt:s.title,loading:"lazy",sx:{width:"100%",height:"100%",display:"block",objectFit:"cover",objectPosition:"center",transform:`translateY(${$s}px)`,opacity:te,transition:"opacity 0.1s ease-out",willChange:"transform, opacity"}}),(a==null?void 0:a.id)===s.user_id&&n&&e.jsx(b,{onClick:r=>{r.stopPropagation(),pe(!0)},sx:{position:"absolute",top:20,right:20,bgcolor:"rgba(255, 255, 255, 0.95)","&:hover":{bgcolor:"white",transform:"scale(1.05)"},boxShadow:3,zIndex:20,opacity:te,transition:"opacity 0.1s ease-out"},children:e.jsx(ws,{size:20})}),v.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:r=>{r.stopPropagation(),fe()},disabled:A===0,sx:{position:"absolute",left:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:te,transition:"opacity 0.1s ease-out"},children:e.jsx($,{})}),e.jsx(b,{onClick:r=>{r.stopPropagation(),be()},disabled:A===v.length-1,sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.5)",opacity:.5},boxShadow:2,zIndex:2,opacity:te,transition:"opacity 0.1s ease-out"},children:e.jsx(U,{})}),e.jsxs(t,{sx:{position:"absolute",bottom:16,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.6)",color:"white",px:2,py:.5,borderRadius:2,fontSize:"0.875rem",fontWeight:600,zIndex:20,opacity:te,transition:"opacity 0.1s ease-out"},children:[A+1," / ",v.length]})]})]}),_.length===0&&e.jsx(t,{sx:{height:{xs:"400px",md:"400px"}}}),_.length>0&&e.jsx(t,{sx:{height:{xs:"400px",md:"400px"}}}),e.jsxs(t,{sx:{position:"sticky",top:55,left:0,right:0,width:"100%",bgcolor:"white",borderBottom:"1px solid #e0e0e0",zIndex:100,px:2,py:1,display:"flex",alignItems:"center",justifyContent:"space-between"},children:[e.jsx(z,{variant:"text",startIcon:e.jsx($,{size:18}),onClick:ss,sx:{textTransform:"none",fontWeight:600,color:"text.secondary",fontSize:"0.9375rem",px:0,bgcolor:"rgba(0, 0, 0, 0.02)","&:hover":{bgcolor:"rgba(0, 0, 0, 0.04)",color:"primary.main"}},children:"Zurück zur Liste"}),e.jsxs(t,{sx:{display:"flex",gap:1,alignItems:"center"},children:[(a==null?void 0:a.id)===s.user_id&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5,px:1.25,py:.4,borderRadius:1.5,bgcolor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.08)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.08)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.08)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.08)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.08)":"rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:(i.status||s.status)==="draft"?"rgba(237, 108, 2, 0.3)":(i.status||s.status)==="published"?"rgba(46, 125, 50, 0.3)":(i.status||s.status)==="paused"?"rgba(158, 158, 158, 0.3)":(i.status||s.status)==="sold"?"rgba(211, 47, 47, 0.3)":(i.status||s.status)==="reserved"?"rgba(2, 136, 209, 0.3)":"rgba(0, 0, 0, 0.2)"},children:[e.jsx(t,{sx:{width:5,height:5,borderRadius:"50%",bgcolor:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.6)"}}),e.jsx(o,{sx:{fontSize:"10px",fontWeight:600,color:(i.status||s.status)==="draft"?"#ed6c02":(i.status||s.status)==="published"?"#2e7d32":(i.status||s.status)==="paused"?"#9e9e9e":(i.status||s.status)==="sold"?"#d32f2f":(i.status||s.status)==="reserved"?"#0288d1":"rgba(0, 0, 0, 0.7)"},children:(i.status||s.status)==="draft"?"Entwurf":(i.status||s.status)==="published"?"Veröffentlicht":(i.status||s.status)==="paused"?"Pausiert":(i.status||s.status)==="sold"?"Verkauft":(i.status||s.status)==="reserved"?"Reserviert":(i.status||s.status)==="archived"?"Archiviert":(i.status||s.status)==="inactive"?"Inaktiv":"Aktiv"})]}),e.jsx(b,{onClick:()=>J(!n),size:"small",sx:{color:n?"primary.main":"text.primary",bgcolor:n?"rgba(25, 118, 210, 0.08)":"transparent","&:hover":{bgcolor:n?"rgba(25, 118, 210, 0.12)":"rgba(0,0,0,0.04)"}},children:e.jsx(Fe,{size:18})})]}),e.jsx(b,{onClick:rs,disabled:!a||S,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:s&&f(s.id)?e.jsx(we,{size:18,fill:"currentColor"}):e.jsx(we,{size:18})}),e.jsx(b,{onClick:is,size:"small",sx:{color:"text.primary","&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:e.jsx(Ce,{size:18})})]})]})]}),e.jsxs(t,{sx:{p:l?2:3,px:l?2:3,maxWidth:800,bgcolor:"white",borderRadius:0,position:"relative",zIndex:10},children:[e.jsx(t,{ref:Ze,sx:{mb:l?1:3},children:e.jsx(E,{value:i.title||s.title,isEditing:n,onChange:r=>u("title",r),onSave:w,variant:l?"h5":"h4",placeholder:"Artikeltitel"})}),e.jsxs(t,{sx:{display:"flex",gap:2,alignItems:"center",flexWrap:"wrap",mb:1.5},children:[(s.postal_code||s.location)&&e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(Te,{size:18,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:s.postal_code&&s.location?`${s.postal_code} ${s.location}`:s.postal_code||s.location})]}),e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(qt,{size:18,color:"#666"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:Et(s.created_at)})]})]}),e.jsx(t,{sx:{mb:l?1.5:3},children:n?e.jsxs(t,{children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",gap:1.5},children:(i.is_free!==void 0?i.is_free:s.is_free)?e.jsx(o,{variant:l?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Zu verschenken"}):(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?e.jsx(o,{variant:l?"h4":"h3",color:"primary.main",fontWeight:"bold",children:"Auf Anfrage"}):e.jsxs(e.Fragment,{children:[e.jsx(E,{value:String(i.price!==void 0?i.price:s.price),isEditing:n,onChange:r=>u("price",parseFloat(r)||0),onSave:w,type:"number",variant:l?"h4":"h3",placeholder:"0.00",displayValue:`${parseFloat(String(i.price!==void 0?i.price:s.price)).toFixed(2)} €`,displayColor:"primary.main"}),(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(X,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})}),e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap",mt:1,alignItems:"center"},children:[e.jsxs(t,{onClick:()=>{const r=!(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable);u("price_negotiable",r),r&&(u("is_free",!1),u("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"not-allowed":"pointer",opacity:(i.is_free!==void 0?i.is_free:s.is_free)||(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?.5:1,userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_negotiable!==void 0?i.price_negotiable:s.price_negotiable)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"VB"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.is_free!==void 0?i.is_free:s.is_free);u("is_free",r),r&&(u("price_negotiable",!1),u("price_on_request",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.is_free!==void 0?i.is_free:s.is_free)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.is_free!==void 0?i.is_free:s.is_free)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"Gratis"})]}),e.jsxs(t,{onClick:()=>{const r=!(i.price_on_request!==void 0?i.price_on_request:s.price_on_request);u("price_on_request",r),r&&(u("is_free",!1),u("price_negotiable",!1))},sx:{display:"flex",alignItems:"center",gap:.75,cursor:"pointer",userSelect:"none"},children:[e.jsx(t,{sx:{width:20,height:20,border:"2px solid",borderColor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"#666",borderRadius:.5,display:"flex",alignItems:"center",justifyContent:"center",bgcolor:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)?"primary.main":"transparent",transition:"all 0.2s ease"},children:(i.price_on_request!==void 0?i.price_on_request:s.price_on_request)&&e.jsx(t,{sx:{width:12,height:8,borderLeft:"2px solid white",borderBottom:"2px solid white",transform:"rotate(-45deg)",mb:.5}})}),e.jsx(o,{variant:"body1",sx:{color:"text.primary"},children:"Auf Anfrage"})]})]})]}):e.jsx(t,{children:e.jsxs(o,{variant:l?"h4":"h3",color:"primary.main",fontWeight:"bold",children:[s.is_free?"Zu verschenken":s.price_on_request?"Auf Anfrage":`${s.price.toFixed(2)} €`,s.price_negotiable&&!s.is_free&&!s.price_on_request&&e.jsx(X,{label:"VB",size:"small",sx:{ml:1.5,height:28,fontWeight:700,bgcolor:"warning.main",color:"white"}})]})})}),e.jsx(t,{sx:{display:"flex",gap:1,mb:l?1.5:3,flexWrap:"wrap",alignItems:"center"},children:e.jsxs(t,{sx:{display:"flex",gap:2,flexWrap:"wrap",width:"100%"},children:[e.jsx(t,{sx:{minWidth:200,flex:1},children:e.jsx(De,{value:i.condition||s.condition||"",isEditing:n,onChange:r=>u("condition",r),onSave:w,options:Tt,placeholder:"Zustand wählen",label:"Zustand"})}),e.jsx(t,{sx:{minWidth:200,flex:1},children:e.jsx(E,{value:i.brand||s.brand||"",isEditing:n,onChange:r=>u("brand",r),onSave:w,placeholder:"Marke",label:"Marke"})})]})}),e.jsx(Q,{sx:{my:l?2:3}}),e.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Beschreibung"}),e.jsx(E,{value:i.description||s.description,isEditing:n,onChange:r=>u("description",r),onSave:w,multiline:!0,rows:12,placeholder:"Artikelbeschreibung"}),(s.category||s.subcategory||s.size||s.weight||s.dimensions_length||s.material||((ds=s.colors)==null?void 0:ds.length)||s.style||((hs=s.features)==null?void 0:hs.length)||((xs=s.accessories)==null?void 0:xs.length)||s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt")&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{sx:{my:l?2:3}}),e.jsx(o,{variant:"h6",sx:{mb:3,fontWeight:600},children:"Produktdetails"}),e.jsxs(t,{sx:{display:"grid",gap:2},children:[(s.category||s.subcategory||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#2196f3":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(Nt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(De,{value:i.category||s.category||"",isEditing:n,onSave:w,onChange:r=>u("category",r),options:[{value:"Elektronik",label:"Elektronik"},{value:"Kleidung",label:"Kleidung"},{value:"Möbel",label:"Möbel"},{value:"Bücher",label:"Bücher"},{value:"Sport",label:"Sport"},{value:"Spielzeug",label:"Spielzeug"},{value:"Haushalt",label:"Haushalt"},{value:"Garten",label:"Garten"},{value:"Auto",label:"Auto & Motorrad"},{value:"Sonstiges",label:"Sonstiges"}],placeholder:"Kategorie wählen",label:"Kategorie"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Kategorie"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.category,s.subcategory].filter(Boolean).join(" › ")})]})})]}),(s.size&&s.size.toLowerCase()!=="unbekannt"||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(Mt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(E,{value:i.size||s.size||"",isEditing:n,onSave:w,onChange:r=>u("size",r),label:"Größe",placeholder:"z.B. XL, 42, 180cm"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Größe"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.size})]})})]}),(s.weight&&s.weight.toLowerCase()!=="unbekannt"||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"warning.main"},children:e.jsx(Lt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(E,{value:i.weight||s.weight||"",isEditing:n,onSave:w,onChange:r=>u("weight",r),label:"Gewicht",placeholder:"z.B. 500g, 2kg"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Gewicht"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.weight})]})})]}),(s.dimensions_length||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(Bt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsxs(t,{sx:{display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(E,{value:i.dimensions_length||s.dimensions_length||"",isEditing:n,onSave:w,onChange:r=>u("dimensions_length",r),label:"Länge (cm)",placeholder:"Länge"}),e.jsx(E,{value:i.dimensions_width||s.dimensions_width||"",isEditing:n,onSave:w,onChange:r=>u("dimensions_width",r),label:"Breite (cm)",placeholder:"Breite"}),e.jsx(E,{value:i.dimensions_height||s.dimensions_height||"",isEditing:n,onSave:w,onChange:r=>u("dimensions_height",r),label:"Höhe (cm)",placeholder:"Höhe"})]}):s.dimensions_length&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Abmessungen"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:[s.dimensions_length,s.dimensions_width,s.dimensions_height].filter(Boolean).join(" × ")})]})})]}),(s.material&&s.material.toLowerCase()!=="unbekannt"||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"secondary.main"},children:e.jsx(Pe,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(E,{value:i.material||s.material||"",isEditing:n,onSave:w,onChange:r=>u("material",r),label:"Material",placeholder:"z.B. Baumwolle, Holz, Metall"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Material"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.material})]})})]}),(s.style&&s.style.toLowerCase()!=="unbekannt"||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"primary.main"},children:e.jsx(At,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(E,{value:i.style||s.style||"",isEditing:n,onSave:w,onChange:r=>u("style",r),label:"Stil",placeholder:"z.B. Modern, Vintage, Klassisch"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Stil"}),e.jsx(o,{variant:"body2",sx:{fontSize:"0.95rem",fontWeight:500},children:s.style})]})})]}),(((ps=s.colors)==null?void 0:ps.length)>0||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"error.main"},children:e.jsx(Pt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(Se,{value:i.colors||s.colors||[],isEditing:n,onSave:w,onChange:r=>u("colors",r),label:"Farben",placeholder:"Farbe hinzufügen",color:"primary"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Farben"}),e.jsx(t,{sx:{display:"flex",gap:1,flexWrap:"wrap",mt:1},children:(gs=s.colors)==null?void 0:gs.map((r,p)=>e.jsx(X,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"primary.50",color:"primary.dark",border:1,borderColor:"primary.200"}},p))})]})})]}),(((us=s.features)==null?void 0:us.length)>0||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#e8f5e9":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#4caf50":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"success.main"},children:e.jsx(Pe,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(Se,{value:i.features||s.features||[],isEditing:n,onSave:w,onChange:r=>u("features",r),label:"Eigenschaften",placeholder:"Eigenschaft hinzufügen",color:"success"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Eigenschaften"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:(fs=s.features)==null?void 0:fs.map((r,p)=>e.jsx(X,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"success.50",color:"success.dark",border:1,borderColor:"success.200"}},p))})]})})]}),(((bs=s.accessories)==null?void 0:bs.length)>0||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#e3f2fd":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#2196f3":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"info.main"},children:e.jsx(Ne,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(Se,{value:i.accessories||s.accessories||[],isEditing:n,onSave:w,onChange:r=>u("accessories",r),label:"Zubehör",placeholder:"Zubehör hinzufügen",color:"info"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.75},children:"Zubehör"}),e.jsx(t,{sx:{display:"flex",gap:.75,flexWrap:"wrap"},children:s.accessories.map((r,p)=>e.jsx(X,{label:r,size:"small",sx:{height:26,fontSize:"0.85rem",fontWeight:500,bgcolor:"info.50",color:"info.dark",border:1,borderColor:"info.200"}},p))})]})})]}),(s.serial_number&&s.serial_number.toLowerCase()!=="unbekannt"||n)&&e.jsxs(t,{sx:{display:"flex",gap:1.5,p:2,bgcolor:n?"#fff3e0":"#f8f9fa",borderRadius:2,border:"1px solid",borderColor:n?"#ff9800":"grey.200"},children:[!n&&e.jsx(t,{sx:{mt:.25,color:"grey.600"},children:e.jsx(Vt,{size:20})}),e.jsx(t,{sx:{flex:1},children:n?e.jsx(E,{value:i.serial_number||s.serial_number||"",isEditing:n,onSave:w,onChange:r=>u("serial_number",r),label:"Seriennummer",placeholder:"Seriennummer oder Artikelnummer"}):e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"caption",color:"text.secondary",sx:{fontWeight:600,fontSize:"0.75rem",textTransform:"uppercase",letterSpacing:.8,display:"block",mb:.5},children:"Seriennummer"}),e.jsx(o,{variant:"body2",sx:{fontFamily:"monospace",fontSize:"0.95rem",color:"text.primary",fontWeight:500},children:s.serial_number})]})})]})]})]}),(((ms=s.tags)==null?void 0:ms.length)>0||n)&&e.jsxs(t,{sx:{mt:3,mb:3},children:[e.jsx(o,{variant:"subtitle2",color:"text.secondary",sx:{fontWeight:600,mb:1},children:"Tags"}),n?e.jsx(Se,{value:i.tags||s.tags||[],isEditing:n,onSave:w,onChange:r=>u("tags",r),placeholder:"Tag hinzufügen und Enter drücken"}):e.jsx(t,{sx:{display:"flex",gap:.5,flexWrap:"wrap"},children:s.tags.map((r,p)=>e.jsx(X,{label:`#${r}`,size:"small",variant:"filled"},p))})]}),e.jsx(Q,{sx:{my:l?2:3}}),(s.snapshot_shipping_enabled||s.snapshot_pickup_enabled||n)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"h6",sx:{mb:2,fontWeight:600},children:"Versand & Abholung"}),n?e.jsxs(e.Fragment,{children:[e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Te,{size:l?18:20,color:"#1976d2"}),e.jsx(ks,{control:e.jsx(Ss,{checked:i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled,onChange:r=>u("snapshot_pickup_enabled",r.target.checked)}),label:e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"}),sx:{m:0}})]}),(i.snapshot_pickup_enabled!==void 0?i.snapshot_pickup_enabled:s.snapshot_pickup_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:1},children:a&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[s.snapshot_pickup_address,e.jsx("br",{}),s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]}):e.jsx(e.Fragment,{children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"})}),e.jsx(E,{value:i.snapshot_location_description!==void 0?i.snapshot_location_description:s.snapshot_location_description||"",isEditing:n,onChange:r=>u("snapshot_location_description",r),onSave:w,placeholder:"Optionale Beschreibung zur Abholung",label:"Abholbeschreibung"})]})]}),e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Ae,{size:l?18:20,color:"#1976d2"}),e.jsx(ks,{control:e.jsx(Ss,{checked:i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled,onChange:r=>u("snapshot_shipping_enabled",r.target.checked)}),label:e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"}),sx:{m:0}})]}),(i.snapshot_shipping_enabled!==void 0?i.snapshot_shipping_enabled:s.snapshot_shipping_enabled)&&e.jsxs(e.Fragment,{children:[e.jsx(De,{value:i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type||"fixed",isEditing:n,onChange:r=>u("snapshot_shipping_cost_type",r),onSave:w,options:[{value:"free",label:"Kostenloser Versand"},{value:"fixed",label:"Feste Versandkosten"},{value:"ai_calculated",label:"KI-berechnet"}],label:"Versandkostentyp"}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="fixed"&&e.jsx(t,{sx:{mt:1},children:e.jsx(E,{value:String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0),isEditing:n,onChange:r=>u("snapshot_shipping_cost",parseFloat(r)||0),onSave:w,type:"number",placeholder:"0.00",label:"Versandkosten (€)",displayValue:`${parseFloat(String(i.snapshot_shipping_cost!==void 0?i.snapshot_shipping_cost:s.snapshot_shipping_cost||0)).toFixed(2)} €`})}),(i.snapshot_shipping_cost_type!==void 0?i.snapshot_shipping_cost_type:s.snapshot_shipping_cost_type)==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mt:1.5,p:1.5,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ne,{size:16,color:"#f57c00"}),e.jsx(o,{variant:"body2",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5,fontSize:"0.875rem"},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(o,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:.5,fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(o,{variant:"caption",color:"text.secondary",sx:{display:"block",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]})]}),e.jsx(t,{sx:{mt:1},children:e.jsx(E,{value:i.snapshot_shipping_description!==void 0?i.snapshot_shipping_description:s.snapshot_shipping_description||"",isEditing:n,onChange:r=>u("snapshot_shipping_description",r),onSave:w,placeholder:"Optionale Versandbeschreibung",label:"Versandbeschreibung"})})]})]})]}):e.jsxs(e.Fragment,{children:[s.snapshot_pickup_enabled&&e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Te,{size:l?18:20,color:"#1976d2"}),e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,children:"Abholung möglich"})]}),a&&s.snapshot_show_location_publicly&&s.snapshot_pickup_address?e.jsxs(e.Fragment,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:s.snapshot_pickup_address}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:[s.snapshot_pickup_postal_code," ",s.snapshot_pickup_city,", ",s.snapshot_pickup_country]})]}):e.jsx(o,{variant:"body2",color:"text.secondary",children:s.location||s.snapshot_pickup_city?e.jsxs(e.Fragment,{children:["Standort: ",s.location||s.snapshot_pickup_city,s.snapshot_pickup_country?`, ${s.snapshot_pickup_country}`:""]}):"Standort auf Anfrage"}),s.snapshot_location_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_location_description})]}),s.snapshot_shipping_enabled&&e.jsxs(e.Fragment,{children:[s.snapshot_shipping_cost_type==="free"&&e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ae,{size:l?18:20,color:"#1976d2"}),e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Versandkosten: Kostenlos"}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="fixed"&&e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#f9f9f9",borderRadius:2,border:"1px solid #e0e0e0"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1},children:[e.jsx(Ae,{size:l?18:20,color:"#1976d2"}),e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,children:"Versand verfügbar"})]}),e.jsxs(o,{variant:"body2",color:"text.secondary",children:["Versandkosten: ",s.snapshot_shipping_cost&&s.snapshot_shipping_cost>0?`${s.snapshot_shipping_cost.toFixed(2)} €`:"Auf Anfrage"]}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontStyle:"italic"},children:s.snapshot_shipping_description})]}),s.snapshot_shipping_cost_type==="ai_calculated"&&(s.ai_shipping_domestic||s.ai_shipping_international)&&e.jsxs(t,{sx:{mb:2,p:l?1.5:2,bgcolor:"#fff3e0",borderRadius:2,border:"1px solid #ffe0b2"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(Ne,{size:l?18:20,color:"#f57c00"}),e.jsx(o,{variant:l?"body1":"subtitle1",fontWeight:600,color:"#e65100",children:"KI-berechnete Versandkosten"})]}),s.ai_shipping_domestic&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["📦 ",(s.snapshot_pickup_country||s.shipping_from_country)==="AT"?"Österreich":(s.snapshot_pickup_country||s.shipping_from_country)==="DE"?"Deutschland":"Inland",": ca. ",s.ai_shipping_domestic.toFixed(2)," €"]}),s.ai_shipping_international&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mb:.5},children:["🌍 EU-Ausland: ca. ",s.ai_shipping_international.toFixed(2)," €"]}),s.estimated_weight_kg&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{mt:1,fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätztes Gewicht: ",s.estimated_weight_kg," kg"]}),s.package_dimensions&&e.jsxs(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.8rem",fontStyle:"italic"},children:["Geschätzte Maße: ",s.package_dimensions.length,"×",s.package_dimensions.width,"×",s.package_dimensions.height," cm"]}),e.jsx(o,{variant:"caption",color:"text.secondary",sx:{display:"block",mt:1.5,fontSize:"0.75rem"},children:"ⓘ Diese Versandkosten wurden automatisch von der KI basierend auf Größe und Gewicht geschätzt."}),s.snapshot_shipping_description&&e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mt:1.5,fontStyle:"italic"},children:s.snapshot_shipping_description})]})]})]}),e.jsx(Q,{sx:{my:l?2:3}})]}),!n&&s.user_id&&e.jsx(t,{sx:{mb:l?2:3},children:e.jsx(lr,{userId:s.user_id,currentItemId:s.id})}),e.jsxs(t,{sx:{bgcolor:"#f0f7ff",p:l?2:3,borderRadius:2,mb:l?2:3,border:"1px solid #e3f2fd"},children:[e.jsxs(t,{sx:{display:"flex",alignItems:"center",gap:1,mb:1.5},children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600},children:"Verkäufer kontaktieren"}),(W==null?void 0:W.phone_verified)&&e.jsx(X,{icon:e.jsx(Ws,{size:14}),label:"Telefon verifiziert",size:"small",color:"success",sx:{height:24}})]}),e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2,lineHeight:1.6},children:"Interesse an diesem Artikel? Kontaktiere den Verkäufer für weitere Informationen oder um einen Kauf zu vereinbaren."}),(F==null?void 0:F.phone)&&(F==null?void 0:F.show_phone_publicly)&&e.jsxs(t,{sx:{mb:2,p:1.5,bgcolor:"white",borderRadius:1,border:"1px solid #e3f2fd",display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(t,{sx:{display:"flex",alignItems:"center",justifyContent:"center",bgcolor:"primary.main",color:"white",borderRadius:"50%",width:36,height:36,flexShrink:0},children:e.jsx($t,{size:18})}),e.jsxs(t,{sx:{flex:1},children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{fontSize:"0.75rem",mb:.25},children:"Telefon"}),e.jsx(o,{variant:"body1",sx:{fontWeight:600,color:"text.primary"},children:e.jsx("a",{href:`tel:${F.phone}`,style:{color:"inherit",textDecoration:"none"},children:F.phone})})]})]}),H&&e.jsx(ee,{severity:"success",sx:{mb:2},children:"Nachricht erfolgreich gesendet!"}),Y&&e.jsx(ee,{severity:"error",sx:{mb:2},onClose:()=>N(null),children:Y}),!a&&e.jsx(ee,{severity:"info",sx:{mb:2},children:"Bitte melde dich an, um den Verkäufer zu kontaktieren."}),a&&a.id===s.user_id&&e.jsx(ee,{severity:"info",sx:{mb:0},children:"Dies ist dein eigenes Inserat."}),a&&a.id!==s.user_id&&e.jsxs(e.Fragment,{children:[e.jsx(Be,{fullWidth:!0,multiline:!0,rows:3,placeholder:"Schreibe eine Nachricht an den Verkäufer...",value:V,onChange:r=>O(r.target.value),sx:{mb:2,bgcolor:"white"},disabled:!a,inputRef:Us}),e.jsx(z,{variant:"contained",size:"large",fullWidth:!0,onClick:ot,disabled:!a||!V.trim()||y,startIcon:e.jsx(Ht,{size:18}),children:y?"Wird gesendet...":"Nachricht senden"})]})]}),e.jsxs(o,{variant:"caption",color:"text.disabled",sx:{display:"block",fontSize:l?"0.7rem":"0.75rem"},children:["Inserat-ID: ",s.id.slice(0,8),l&&e.jsx("br",{})," • Veröffentlicht am ",new Date(s.created_at).toLocaleDateString("de-DE",{day:"2-digit",month:"2-digit",year:"numeric"})," um ",new Date(s.created_at).toLocaleTimeString("de-DE",{hour:"2-digit",minute:"2-digit"})]})]})]})]})]}),Ie&&e.jsxs("div",{className:"lightbox-overlay",onClick:()=>le(!1),children:[e.jsx("button",{className:l?g==="left"?"lightbox-close lightbox-close-mobile lightbox-close-left":"lightbox-close lightbox-close-mobile":"lightbox-close",onClick:()=>le(!1),"aria-label":"Schließen",children:"✕"}),v.length>1&&e.jsxs(e.Fragment,{children:[e.jsx(b,{onClick:r=>{r.stopPropagation(),fe()},disabled:A===0,sx:{position:"absolute",left:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx($,{size:32})}),e.jsx(b,{onClick:r=>{r.stopPropagation(),be()},disabled:A===v.length-1,sx:{position:"absolute",right:20,top:"50%",transform:"translateY(-50%)",bgcolor:"rgba(255,255,255,0.9)",color:"black","&:hover":{bgcolor:"white"},"&.Mui-disabled":{bgcolor:"rgba(255,255,255,0.3)",color:"rgba(0,0,0,0.3)"},boxShadow:3,zIndex:1502,width:48,height:48},children:e.jsx(U,{size:32})}),e.jsxs(t,{sx:{position:"absolute",bottom:30,left:"50%",transform:"translateX(-50%)",bgcolor:"rgba(0,0,0,0.7)",color:"white",px:3,py:1,borderRadius:3,fontSize:"1rem",fontWeight:600,zIndex:1502},children:[A+1," / ",v.length]})]}),e.jsx("div",{className:"lightbox-content",onClick:r=>r.stopPropagation(),children:e.jsx("img",{src:Dt(v[A]),alt:s.title,loading:"lazy"})})]}),!l&&e.jsx(t,{sx:{position:"fixed",bottom:0,left:0,right:0,display:"flex",justifyContent:g==="left"?"flex-start":"flex-end",px:3,pb:1.5,gap:1,zIndex:500,pointerEvents:"none","& > *":{pointerEvents:"auto"}},children:g==="right"?e.jsxs(e.Fragment,{children:[ce&&e.jsx(b,{onClick:me,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ke,{size:28})}),_.length>0&&L&&e.jsx(b,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx($,{size:28,color:"#1976d2"})}),_.length>0&&B&&e.jsx(b,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(U,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[_.length>0&&B&&e.jsx(b,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(U,{size:28,color:"#1976d2"})}),_.length>0&&L&&e.jsx(b,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx($,{size:28,color:"#1976d2"})}),ce&&e.jsx(b,{onClick:me,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ke,{size:28})})]})}),l&&e.jsx(t,{sx:{position:"fixed",left:g==="left"?16:"auto",right:g==="left"?"auto":16,bottom:24,display:"flex",gap:1,zIndex:500},children:g==="right"?e.jsxs(e.Fragment,{children:[ce&&e.jsx(b,{onClick:me,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ke,{size:28})}),_.length>0&&L&&e.jsx(b,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx($,{size:28,color:"#1976d2"})}),_.length>0&&B&&e.jsx(b,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(U,{size:28,color:"#1976d2"})})]}):e.jsxs(e.Fragment,{children:[_.length>0&&B&&e.jsx(b,{onClick:()=>I("next"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx(U,{size:28,color:"#1976d2"})}),_.length>0&&L&&e.jsx(b,{onClick:()=>I("prev"),sx:{bgcolor:"rgba(255, 255, 255, 0.85)",backdropFilter:"blur(8px)",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(255, 255, 255, 0.95)",transform:"scale(1.1)"},border:2,borderColor:"rgba(25, 118, 210, 0.8)",transition:"all 0.2s"},children:e.jsx($,{size:28,color:"#1976d2"})}),ce&&e.jsx(b,{onClick:me,sx:{bgcolor:"rgba(25, 118, 210, 0.85)",backdropFilter:"blur(8px)",color:"white",boxShadow:3,width:56,height:56,"&:hover":{bgcolor:"rgba(25, 118, 210, 0.95)",transform:"scale(1.1)"},transition:"all 0.2s"},children:e.jsx(ke,{size:28})})]})}),e.jsx(Is,{open:Gs,onClose:()=>xe(!1),title:"Artikel löschen",maxWidth:"xs",actions:e.jsxs(e.Fragment,{children:[e.jsx(z,{onClick:()=>xe(!1),variant:"outlined",sx:{textTransform:"none"},children:"Abbrechen"}),e.jsx(z,{onClick:async()=>{await k.from("items").delete().eq("id",s==null?void 0:s.id),xe(!1),d("/")},variant:"contained",color:"error",sx:{textTransform:"none"},children:"Löschen"})]}),children:e.jsx(o,{children:"Möchtest du diesen Artikel wirklich löschen? Diese Aktion kann nicht rückgängig gemacht werden."})}),n&&a&&s&&a.id===s.user_id&&e.jsx(ar,{onPublish:ts,onCancel:it,isPublishing:he,autoSaveStatus:st,hasChanges:Xe,isDraft:s.status==="draft",itemStatus:s.status,isFirstItem:Xs}),e.jsx(or,{show:Zs,targetElement:Ze.current,onClose:()=>{Ye(!1),localStorage.setItem("hasSeenItemEditOnboarding","true")},title:"Inline-Bearbeitung",description:"Klicke einfach auf einen beliebigen Bereich wie den Titel, die Beschreibung oder die Bilder, um sie direkt zu bearbeiten. Deine Änderungen werden automatisch gespeichert."}),e.jsx(Is,{open:Qs,onClose:()=>pe(!1),title:"Bilder verwalten",maxWidth:"xl",fullScreen:!0,actions:e.jsx(z,{onClick:()=>pe(!1),variant:"contained",sx:{textTransform:"none"},children:"Fertig"}),children:e.jsx(t,{sx:{height:"100%",overflowY:"auto",p:2},children:e.jsx(zs,{images:i.images||v.map(r=>({preview:r,existingUrl:r,isPrimary:r===v[0]})),onChange:r=>u("images",r),isEditing:n})})}),e.jsxs(Ts,{open:et,onClose:()=>ge(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(Ns,{children:"Inserat ablehnen/sperren"}),e.jsxs(As,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Bitte gib einen Grund für die Ablehnung/Sperrung an. Der Verkäufer wird benachrichtigt."}),e.jsx(Be,{label:"Ablehnungsgrund",multiline:!0,rows:4,fullWidth:!0,value:ue,onChange:r=>Qe(r.target.value),placeholder:"z.B. Verstößt gegen Nutzungsbedingungen, Unerlaubter Inhalt, Falsche Kategorie..."})]}),e.jsxs(Ds,{children:[e.jsx(z,{onClick:()=>ge(!1),children:"Abbrechen"}),e.jsx(z,{variant:"contained",color:"error",onClick:nt,disabled:Je||!ue.trim(),children:"Sperren"})]})]}),e.jsx(Ms,{open:ne.open,autoHideDuration:6e3,onClose:()=>ae({...ne,open:!1}),children:e.jsx(ee,{severity:ne.severity,onClose:()=>ae({...ne,open:!1}),children:ne.message})})]}):null};export{mr as ItemDetailPage};
